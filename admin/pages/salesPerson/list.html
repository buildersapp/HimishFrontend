<!DOCTYPE html>
<html lang="en">
    <?php include('includes/head.php') ?>

    <link rel="stylesheet" href="assets/plugins/datatable/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css">
    <script src="https://cdn.tailwindcss.com"></script>

    <script src="../../assets/js/tailwind.js?v=<?= time() ?>"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@10.3.3/highcharts.js?v=<?= time() ?>"></script>
    <style>
       
        /* Set height for Select2 input box */
        .select2-container {
            width: 100% !important;
            z-index: 99999999 !important;
        }
    
        /* Set height for Select2 input box */
        .select2-container .select2-selection--single {
            height: 40px;  /* Adjust height of the select input box */
        }
    
        .select2-container--default .select2-selection--single .select2-selection__rendered {
            line-height: 40px !important;
        }
    
        .select2-container--default .select2-selection--single .select2-selection__arrow {
            top: 7px !important;
        }
    
        /* Set max-height for the dropdown list */
        .select2-container--default .select2-results__options {
            max-height: 200px;  /* Adjust the dropdown height */
            overflow-y: auto;   /* Enable scrolling if content exceeds height */
        }
        .highlighted-section {
            outline: 2px solid #3F20FB;
            background-color: rgba(63, 32, 251, 0.1);
        }

        .edit-button {
            position: absolute;
            z-index: 1000;
        }
        .group:hover .group-hover\:opacity-100 {
            opacity: 1 !important;
        }
        .group:hover .group-hover\:visible {
            visibility: visible !important;
        }
    </style>
    
    <body>
        <!-- wrapper start  -->
        <div class="wrapper relative">
            <?php include('includes/sidebar.php') ?>

            <!-- header start  -->
            <?php include('includes/nav-header.php') ?>
            <!-- header end  -->

            <!-- content area start  -->
            <div class="user-page-sec">
                <main>
                    <section class="userList">
                        <!-- TABS BOOTSTRAP -->
                        <ul class="nav nav-tabs mb-3 set-sales-person-tabs-all" id="myTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="sales-reps-tab" data-tab="sales-reps-tab" data-bs-toggle="tab" data-bs-target="#sales-reps-tab-pane" type="button" role="tab" aria-controls="sales-reps-tab-pane" aria-selected="true">Sales Reps</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="communities-tab" data-tab="communityTab" data-bs-toggle="tab" data-bs-target="#communities-tab-pane" type="button" role="tab" aria-controls="communities-tab-pane" aria-selected="false">Communities</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="referral-tab" data-tab="referral" data-bs-toggle="tab" data-bs-target="#referral-tab-pane" type="button" role="tab" aria-controls="referral-tab-pane" aria-selected="false">Referral Links</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="commission-tab" data-tab="commission" data-bs-toggle="tab" data-bs-target="#commission-tab-pane" type="button" role="tab" aria-controls="commission-tab-pane" aria-selected="false">Commission Settings</button>
                            </li>
                        </ul>
                        <div class="tab-content mb-5" id="myTabContent">
                            <div class="tab-pane fade show active" id="sales-reps-tab-pane" role="tabpanel" aria-labelledby="sales-reps-tab" tabindex="0">
                                <!-- TAB 1 INNER -->
                                <div id="sales-reps-tab" class="tab-panel set-inner-content-font-12 list-users">
                                    <div id="sales-reps-header" class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                                        <div>
                                            <h2 class="text-lg font-semibold text-gray-900">Sales Representatives</h2>
                                            <p class="text-sm text-gray-500 mt-1">Manage sales reps, their performance, and assignments</p>
                                        </div>
                                        <div class="flex items-center space-x-3 mt-4 sm:mt-0">
                                            <!-- <button class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-sm font-medium">
                                                <i class="fa-solid fa-filter mr-2"></i>Filter
                                            </button> -->
                                            <button class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 text-sm font-medium" title="Add User" data-bs-toggle="modal" data-bs-target="#addUserModal">
                                                <i class="fa-solid fa-plus mr-2"></i>Add Rep
                                            </button>
                                        </div>
                                    </div>

                                    <div id="search-filter-section" class="mb-6">
                                        <div class="flex flex-col sm:flex-row gap-4">
                                            <div class="relative flex-1">
                                                <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                                <input type="text" placeholder="Search sales reps..." id="searchSalesPerson" class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                            </div>
                                            <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" id="statusSalesSelect">
                                             
                                                 <option value="">All Status</option>
                                                <option value="1">Active</option>
                                                <option value="0">Flagged</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div id="sales-reps-table" class="overflow-x-auto">
                                        <table class="w-full" id="salesPersonTable" style="width:100%">
                                            <thead>
                                                <tr class="border-b border-gray-200">
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Rep Name
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Contact
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Total Ads
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Total Earnings
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Last Activity
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">Status</th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200">
                                                <!-- <tr id="rep-row-1" class="hover:bg-gray-50">
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-8 h-8 rounded-full mr-3">
                                                            <div>
                                                                <div class="font-medium text-gray-900">John Smith</div>
                                                                <div class="text-sm text-gray-500">ID: SR001</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">john.smith@email.com</div>
                                                        <div class="text-sm text-gray-500">+1 (555) 123-4567</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">245</div>
                                                        <div class="text-xs text-gray-500">180 Referral / 65 Community</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="font-medium text-gray-900">$12,450</div>
                                                        <div class="text-xs text-gray-500">This month: $2,340</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">2 hours ago</div>
                                                        <div class="text-xs text-gray-500">Dec 15, 2024</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                            <i class="fa-solid fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                                                            Active
                                                        </span>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center space-x-2">
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded" title="View Details">
                                                                <i class="fa-solid fa-eye"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-warning rounded"  data-bs-toggle="modal" data-bs-target="#editUserModal" title="Reassign Links">
                                                                <i class="fa-solid fa-edit"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr> -->
                                                
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- <div id="pagination" class="flex items-center justify-between mt-6">
                                        <div class="text-sm text-gray-700">
                                            Showing <span class="font-medium">1</span> to <span class="font-medium">3</span> of <span class="font-medium">12</span> results
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <button class="px-3 py-2 text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50" disabled="">
                                                <i class="fa-solid fa-chevron-left"></i>
                                            </button>
                                            <button class="px-3 py-2 bg-primary text-white rounded-lg">1</button>
                                            <button class="px-3 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">2</button>
                                            <button class="px-3 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">3</button>
                                            <button class="px-3 py-2 text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">
                                                <i class="fa-solid fa-chevron-right"></i>
                                            </button>
                                        </div>
                                    </div> -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="communities-tab-pane" role="tabpanel" aria-labelledby="communities-tab" tabindex="0">
                                <!-- TAB 2 INNER -->
                                <div id="communities-tab" class="tab-panel set-inner-content-font-12 list-users">
                                    <div id="communities-header" class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                                        <div>
                                            <h2 class="text-lg font-semibold text-gray-900">Communities</h2>
                                            <p class="text-sm text-gray-500 mt-1">Manage communities, ownership</p>
                                        </div>
                                        <div class="flex items-center space-x-3 mt-4 sm:mt-0">
                                           
                                            <button class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 text-sm font-medium"  data-bs-toggle="modal" data-bs-target="#addCommunityModal" >
                                                <i class="fa-solid fa-plus mr-2"></i>Add Community
                                            </button>
                                        </div>
                                    </div>

                                    <div id="search-filter-section" class="mb-6">
                                        <div class="flex flex-col sm:flex-row gap-4">
                                            <div class="relative flex-1">
                                                <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                                <input type="text" id="searchSalesPersonComunity" placeholder="Search communities..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                            </div>
                                            <select id="salesCommunityStatus" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                                <option value="">All Status</option>
                                                <option value="1">Active</option>
                                                <option value="0">Flagged</option>
                                            </select>
                                            <select id="pubPri" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                                <option value="">All Types</option>
                                                <option value="0">Public</option>
                                                <option value="1">Private</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div id="communities-table" class="overflow-x-auto">
                                        <table class="w-full" id="salesPersonCommunityTable" style="width: 100%;">
                                            <thead>
                                                <tr class="border-b border-gray-200">
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Community Name
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Rep (Owner)
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Privacy
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Members
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">Status</th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Created At
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200">
                                                <tr id="community-row-1" class="hover:bg-gray-50">
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                                                <i class="fa-solid fa-users text-blue-600 text-sm"></i>
                                                            </div>
                                                            <div>
                                                                <div class="font-medium text-gray-900">Tech Enthusiasts</div>
                                                                <div class="text-sm text-gray-500">ID: COM001</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <div>
                                                                <div class="text-sm font-medium text-gray-900">John Smith</div>
                                                                <div class="text-xs text-gray-500">SR001</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                            <i class="fa-solid fa-globe mr-1"></i>
                                                            Public
                                                        </span>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900 font-medium">1,247</div>
                                                        <div class="text-xs text-gray-500">+23 this week</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                            <i class="fa-solid fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                                                            Active
                                                        </span>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">3 hours ago</div>
                                                        <div class="text-xs text-gray-500">Dec 15, 2024</div>
                                                    </td>
                                                    
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center space-x-2">
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded" title="View Members">
                                                                <i class="fa-solid fa-users"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-warning rounded" title="Change Commission">
                                                                <i class="fa-solid fa-percentage"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-secondary rounded" title="Transfer Community">
                                                                <i class="fa-solid fa-arrow-right-arrow-left"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                                
                                                </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="referral-tab-pane" role="tabpanel" aria-labelledby="referral-tab" tabindex="0">
                                <!-- TAB 3 INNER -->
                                <div id="referral-links-tab" class="tab-panel set-inner-content-font-12 list-users">
                                    <div id="referral-links-header" class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                                        <div>
                                            <h2 class="text-lg font-semibold text-gray-900">Referral Links</h2>
                                            <p class="text-sm text-gray-500 mt-1">Manage referral links, track performance, and monitor conversions</p>
                                        </div>
                                        <div class="flex items-center space-x-3 mt-4 sm:mt-0">
                                            
                                            <button class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 text-sm font-medium"  data-bs-toggle="modal" data-bs-target="#createNewReferralLinkModal" >
                                                <i class="fa-solid fa-plus mr-2"></i>Create Link
                                            </button>
                                        </div>
                                    </div>

                                    <div id="referral-filters" class="mb-6">
                                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                                            <div class="relative">
                                                <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                                <input type="text" id="searchSalesPersonLink" placeholder="Search links..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                            </div>
                                            <select id="u_id" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                                <option value="">All Sales Reps</option>
                                                <?php foreach($salesPerson as $k => $v) { ?>
                                                    <option value="<?php echo $v['id'];?>"><?php echo $v['name'];?> (SR<?php echo $v['id'];?>)</option>
                                                    <?php } ?>
                                            </select>
                                            <select id="salesLinkStatus" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                                <option value="">All Status</option>
                                                <option value="1" selected>Active</option>
                                                <option value="0">Flagged</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div id="referral-links-table" class="overflow-x-auto">
                                        <table class="w-full" id="getReferralLink" style="width: 100%;">
                                            <thead>
                                                <tr class="border-b border-gray-200">
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Link ID
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Sales Rep
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Post Title
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Created Date
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Expiry Date
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">
                                                        Performance
                                                        <i class="fa-solid fa-sort ml-1 text-gray-400"></i>
                                                    </th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">Status</th>
                                                    <th class="text-left py-2 px-2 font-medium text-gray-700 text-sm">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200">
                                                <tr id="link-row-1" class="hover:bg-gray-50">
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <code class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">REF-4A7B</code>
                                                            <button class="ml-2 p-1 text-gray-400 hover:text-primary" title="Copy Link">
                                                                <i class="fa-solid fa-copy text-xs"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <span class="text-sm text-gray-900">John Smith</span>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Premium Car Wash Service</div>
                                                        <div class="text-xs text-gray-500">Automotive</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Dec 10, 2024</div>
                                                        <div class="text-xs text-gray-500">5 days ago</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Jan 10, 2025</div>
                                                        <div class="text-xs text-gray-500">26 days left</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">124 / 8</div>
                                                        <div class="text-xs text-gray-500">Clicks / Conversions</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                            <i class="fa-solid fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                                                            Active
                                                        </span>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center space-x-2">
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded view-link-btn" title="View Link Details" data-bs-toggle="modal" data-bs-target="#referralLinkDetailModal">
                                                                <i class="fa-solid fa-eye"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded" title="View Linked Ad" data-bs-toggle="modal" data-bs-target="#editReferralLinkModal">
                                                                <i class="fa-solid fa-external-link-alt"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-warning rounded" title="Reassign Link" data-bs-toggle="modal" data-bs-target="#assignToAnotherRepModal">
                                                                <i class="fa-solid fa-user-tag"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-danger rounded" title="Force Expire"  data-bs-toggle="modal" data-bs-target="#disableReferralLinkModal">
                                                                <i class="fa-solid fa-ban"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr id="link-row-2" class="hover:bg-gray-50">
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <code class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">REF-9C2E</code>
                                                            <button class="ml-2 p-1 text-gray-400 hover:text-primary" title="Copy Link">
                                                                <i class="fa-solid fa-copy text-xs"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-5.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <span class="text-sm text-gray-900">Sarah Johnson</span>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Digital Marketing Course</div>
                                                        <div class="text-xs text-gray-500">Education</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Dec 8, 2024</div>
                                                        <div class="text-xs text-gray-500">7 days ago</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Dec 8, 2024</div>
                                                        <div class="text-xs text-red-500">Expired</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">89 / 12</div>
                                                        <div class="text-xs text-gray-500">Clicks / Conversions</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                                            <i class="fa-solid fa-circle text-red-400 mr-1" style="font-size: 6px;"></i>
                                                            Expired
                                                        </span>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center space-x-2">
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded view-link-btn" title="View Link Details" data-bs-toggle="modal" data-bs-target="#referralLinkDetailModal">
                                                                <i class="fa-solid fa-eye"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded" title="View Linked Ad" data-bs-toggle="modal" data-bs-target="#editReferralLinkModal">
                                                                <i class="fa-solid fa-external-link-alt"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-warning rounded" title="Reassign Link" data-bs-toggle="modal" data-bs-target="#assignToAnotherRepModal">
                                                                <i class="fa-solid fa-user-tag"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-danger rounded" title="Force Expire"  data-bs-toggle="modal" data-bs-target="#disableReferralLinkModal">
                                                                <i class="fa-solid fa-ban"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr id="link-row-3" class="hover:bg-gray-50">
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <code class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">REF-1F8D</code>
                                                            <button class="ml-2 p-1 text-gray-400 hover:text-primary" title="Copy Link">
                                                                <i class="fa-solid fa-copy text-xs"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-3.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <span class="text-sm text-gray-900">Mike Wilson</span>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Fitness Equipment Sale</div>
                                                        <div class="text-xs text-gray-500">Health &amp; Fitness</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Dec 12, 2024</div>
                                                        <div class="text-xs text-gray-500">3 days ago</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Feb 12, 2025</div>
                                                        <div class="text-xs text-gray-500">59 days left</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">256 / 15</div>
                                                        <div class="text-xs text-gray-500">Clicks / Conversions</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                            <i class="fa-solid fa-circle text-blue-400 mr-1" style="font-size: 6px;"></i>
                                                            Used
                                                        </span>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center space-x-2">
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded view-link-btn" title="View Link Details" data-bs-toggle="modal" data-bs-target="#referralLinkDetailModal">
                                                                <i class="fa-solid fa-eye"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded" title="View Linked Ad" data-bs-toggle="modal" data-bs-target="#editReferralLinkModal">
                                                                <i class="fa-solid fa-external-link-alt"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-warning rounded" title="Reassign Link" data-bs-toggle="modal" data-bs-target="#assignToAnotherRepModal">
                                                                <i class="fa-solid fa-user-tag"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-danger rounded" title="Force Expire"  data-bs-toggle="modal" data-bs-target="#disableReferralLinkModal">
                                                                <i class="fa-solid fa-ban"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr id="link-row-4" class="hover:bg-gray-50">
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <code class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">REF-5K9L</code>
                                                            <button class="ml-2 p-1 text-gray-400 hover:text-primary" title="Copy Link">
                                                                <i class="fa-solid fa-copy text-xs"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-8.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <span class="text-sm text-gray-900">Alex Chen</span>
                                                        </div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Photography Workshop</div>
                                                        <div class="text-xs text-gray-500">Creative</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Dec 14, 2024</div>
                                                        <div class="text-xs text-gray-500">1 day ago</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">Mar 14, 2025</div>
                                                        <div class="text-xs text-gray-500">89 days left</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="text-sm text-gray-900">67 / 3</div>
                                                        <div class="text-xs text-gray-500">Clicks / Conversions</div>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                            <i class="fa-solid fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                                                            Active
                                                        </span>
                                                    </td>
                                                    <td class="py-2 px-2">
                                                        <div class="flex items-center space-x-2">
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded view-link-btn" title="View Link Details" data-bs-toggle="modal" data-bs-target="#referralLinkDetailModal">
                                                                <i class="fa-solid fa-eye"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-primary rounded" title="View Linked Ad" data-bs-toggle="modal" data-bs-target="#editReferralLinkModal">
                                                                <i class="fa-solid fa-external-link-alt"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-warning rounded" title="Reassign Link" data-bs-toggle="modal" data-bs-target="#assignToAnotherRepModal">
                                                                <i class="fa-solid fa-user-tag"></i>
                                                            </button>
                                                            <button class="p-1.5 text-gray-400 hover:text-danger rounded" title="Force Expire"  data-bs-toggle="modal" data-bs-target="#disableReferralLinkModal">
                                                                <i class="fa-solid fa-ban"></i>
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="commission-tab-pane" role="tabpanel" aria-labelledby="commission-tab" tabindex="0">
                                <!-- TAB 4 INNER -->
                            <form method="post">
                                <div id="settings-tab" class="tab-panel set-inner-content-font-12 list-users">
                                    <!-- Commission Settings Header -->
                                    <div id="settings-header" class="mb-6">
                                        <h2 class="text-lg font-semibold text-gray-900">Commission Settings</h2>
                                        <p class="text-sm text-gray-500 mt-1">Configure system-wide defaults for referral links and commission rates</p>
                                    </div>

                                    <div id="settings-grid" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                        <div id="referral-settings-card" class="bg-gray-50 rounded-lg p-6">
                                            <div class="flex items-center mb-4">
                                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                                    <i class="fa-solid fa-link text-primary text-sm"></i>
                                                </div>
                                                <h3 class="text-lg font-medium text-gray-900">Referral Link Settings</h3>
                                            </div>
                                            
                                            <div class="space-y-4">
                                                <div id="expiry-setting">
                                                    <div class="flex items-center mb-2">
                                                        <label class="block text-sm font-medium text-gray-700">Default Referral Link Expiry</label>
                                                        <button id="expiry-info" class="ml-2 text-gray-400 hover:text-gray-600 relative group">
                                                            <i class="fa-solid fa-circle-info"></i>
                                                            <div class="absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                How long referral links stay valid after creation.
                                                                <div class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </button>
                                                    </div>
                                                    <div class="relative">
                                                        <input type="number" value="<?php echo $final['referral_link_expire'];?>" name="referral_link_expire" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-12">
                                                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                            <span class="text-gray-500 text-sm">days</span>
                                                        </div>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">How long referral links remain active before expiring</p>
                                                </div>

                                                <div id="commission-rate-setting">
                                                    <div class="flex items-center mb-2">
                                                        <label class="block text-sm font-medium text-gray-700">Default Commission Rate</label>
                                                        <button id="commission-info" class="ml-2 text-gray-400 hover:text-gray-600 relative group">
                                                            <i class="fa-solid fa-circle-info"></i>
                                                            <div class="absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Applies automatically when new reps are created.
                                                                <div class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </button>
                                                    </div>
                                                    <div class="relative">
                                                        <input type="number" 
                                                        name="sale_person_commission" value="<?php echo $final['sale_person_commission'];?>" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-8">
                                                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                            <span class="text-gray-500 text-sm">%</span>
                                                        </div>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Default commission percentage for new sales reps</p>
                                                </div>

                                                <div id="inactivity-setting">
                                                    <div class="flex items-center mb-2">
                                                        <label class="block text-sm font-medium text-gray-700">Inactivity Threshold</label>
                                                        <button id="inactivity-info" class="ml-2 text-gray-400 hover:text-gray-600 relative group">
                                                            <i class="fa-solid fa-circle-info"></i>
                                                            <div class="absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Number of days without activity before flagging a rep.
                                                                <div class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </button>
                                                    </div>
                                                    <div class="relative">
                                                        <input type="number"
                                                        name="sale_person_threshold" value="<?php echo $final['sale_person_threshold'];?>" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-12">
                                                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                            <span class="text-gray-500 text-sm">days</span>
                                                        </div>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Days of inactivity before flagging a sales rep</p>
                                                </div>
                                            </div>
                                        </div>

                                        <div id="community-settings-card" class="bg-gray-50 rounded-lg p-6">
                                            <div class="flex items-center mb-4">
                                                <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                                    <i class="fa-solid fa-users-gear text-success text-sm"></i>
                                                </div>
                                                <h3 class="text-lg font-medium text-gray-900">Community Settings</h3>
                                            </div>

                                            <div class="space-y-4">
                                                <div id="auto-approve-setting">
                                                    <div class="flex items-center justify-between">
                                                        <div class="flex items-center">
                                                            <label class="block text-sm font-medium text-gray-700">Auto-Approve Private Community Joins</label>
                                                            <button id="auto-approve-info" class="ml-2 text-gray-400 hover:text-gray-600 relative group">
                                                                <i class="fa-solid fa-circle-info"></i>
                                                                <div class="absolute left-0 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                    Automatically approve new join requests for private communities.
                                                                    <div class="absolute -bottom-1 left-4 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                                </div>
                                                            </button>
                                                        </div>
                                                        <div class="relative">
                                                            <input type="hidden" name="auto_approve_join_community" value="0">
                                                            <input type="checkbox"
                                                            name="auto_approve_join_community" 
                                                            class="sr-only" checked="<?php echo ($final['auto_approve_join_community'] ==1) ? 'checked' : '';?>" value="<?php echo $final['auto_approve_join_community'];?>">
                                                            
                                                        </div>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Automatically approve new members joining private communities</p>
                                                </div>

                                                <div id="max-communities-setting">
                                                    <div class="flex items-center mb-2">
                                                        <label class="block text-sm font-medium text-gray-700">Max Communities per Rep</label>
                                                        <button id="max-communities-info" class="ml-2 text-gray-400 hover:text-gray-600 relative group">
                                                            <i class="fa-solid fa-circle-info"></i>
                                                            <div class="absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Upper limit of communities one rep can own.
                                                                <div class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </button>
                                                    </div>
                                                    <input type="number" name="max_community_per_rep" value="<?php echo $final['max_community_per_rep'];?>" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                                    <p class="text-xs text-gray-500 mt-1">Maximum number of communities a sales rep can manage</p>
                                                </div>

                                                <div id="community-commission-setting">
                                                    <div class="flex items-center mb-2">
                                                        <label class="block text-sm font-medium text-gray-700">Community Commission Rate</label>
                                                        <button id="community-commission-info" class="ml-2 text-gray-400 hover:text-gray-600 relative group">
                                                            <i class="fa-solid fa-circle-info"></i>
                                                            <div class="absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Commission rate specifically for community-based sales.
                                                                <div class="absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </button>
                                                    </div>
                                                    <div class="relative">
                                                        <input type="number"
                                                        name="community_commission" value="<?php echo $final['community_commission'];?>" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-8">
                                                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                            <span class="text-gray-500 text-sm">%</span>
                                                        </div>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1">Commission rate for community-based sales</p>
                                                </div>
                                            </div>
                                        </div>

                                        <div id="community-templates-card" class="bg-gray-50 rounded-lg p-6">
                                            <div class="flex items-center mb-4">
                                            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                                <i class="fa-solid fa-comments text-purple-600 text-sm"></i>
                                            </div>
                                            <h3 class="text-lg font-medium text-gray-900">Community Templates</h3>
                                            </div>

                                            <div class="space-y-6">
                                            <!-- WhatsApp -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default WhatsApp Template</label>
                                                <textarea id="community_default_template_whatsapp" name="community_default_template_whatsapp"  class="ckeditor w-full"><?php echo $final['community_default_template_whatsapp'];?></textarea>
                                            </div>

                                            <!-- SMS -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default SMS Template</label>
                                                <textarea id="community_default_template_sms" class="ckeditor w-full" name="community_default_template_sms"><?php echo $final['community_default_template_sms'];?></textarea>
                                            </div>

                                            <!-- Email -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default Email Template</label>
                                                <textarea id="community_default_template_email" name="community_default_template_email" class="ckeditor w-full"><?php echo $final['community_default_template_email'];?></textarea>
                                            </div>

                                            <!-- Copy Share -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default Copy Share Template</label>
                                                <textarea id="community_default_template_copy_share" name="community_default_template_copy_share" class="ckeditor w-full"><?php echo $final['community_default_template_copy_share'];?></textarea>
                                            </div>
                                            </div>
                                        </div>

                                        <!-- Post Templates -->
                                        <div id="post-templates-card" class="bg-gray-50 rounded-lg p-6">
                                            <div class="flex items-center mb-4">
                                            <div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                                                <i class="fa-solid fa-file-lines text-yellow-600 text-sm"></i>
                                            </div>
                                            <h3 class="text-lg font-medium text-gray-900">Post Templates</h3>
                                            </div>

                                            <div class="space-y-6">
                                            <!-- WhatsApp -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default WhatsApp Template</label>
                                                <textarea id="post_default_template_whatsapp" name="post_default_template_whatsapp" class="ckeditor w-full"><?php echo $final['post_default_template_whatsapp'];?></textarea>
                                            </div>

                                            <!-- SMS -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default SMS Template</label>
                                                <textarea id="post_default_template_sms"
                                                name="post_default_template_sms" class="ckeditor w-full"><?php echo $final['post_default_template_sms'];?></textarea>
                                            </div>

                                            <!-- Email -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default Email Template</label>
                                                <textarea 
                                                name="post_default_template_email" id="post_default_template_email" class="ckeditor w-full"><?php echo $final['post_default_template_email'];?></textarea>
                                            </div>

                                            <!-- Copy Share -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Default Copy Share Template</label>
                                                <textarea 
                                                name="post_default_template_copy_share" id="post_default_template_copy_share" class="ckeditor w-full"><?php echo $final['post_default_template_copy_share'];?></textarea>
                                            </div>
                                            </div>
                                        </div>






                                    </div>

                                    <div id="notification-settings-card" class="bg-gray-50 rounded-lg p-6 mt-6">
                                        <div class="flex items-center mb-4">
                                            <div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                                                <i class="fa-solid fa-bell text-warning text-sm"></i>
                                            </div>
                                            <h3 class="text-lg font-medium text-gray-900">Notification Settings</h3>
                                        </div>

                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div id="email-notifications">
                                                <h4 class="font-medium text-gray-900 mb-3">Email Notifications</h4>
                                                <div class="space-y-3">
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm text-gray-700 relative group">
                                                            Low performance alerts
                                                            <div class="absolute left-0 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Receive email alerts when sales reps fall below performance thresholds.
                                                                <div class="absolute -bottom-1 left-4 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </span>
                                                       <div class="relative">
                                                        <input type="hidden" name="low_performance" value="0">
                                                        <input type="checkbox" 
                                                            id="email-performance" value="1"
                                                            name="low_performance"
                                                            class="sr-only" 
                                                            <?php echo (isset($final['low_performance']) && $final['low_performance'] == 1) ? 'checked' : ''; ?>>
                                                    </div>

                                                    </div>
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm text-gray-700 relative group">
                                                            Commission milestones
                                                            <div class="absolute left-0 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Get notified when reps reach commission milestones.
                                                                <div class="absolute -bottom-1 left-4 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </span>
                                                       <div class="relative">
                                                          <input type="hidden" name="commission_milestone" value="0">
                                                            <input type="checkbox" 
                                                                id="email-commission" 
                                                                value="1"
                                                                name="commission_milestone" 
                                                                class="sr-only" 
                                                                <?php echo (isset($final['commission_milestone']) && $final['commission_milestone'] == 1) ? 'checked' : ''; ?>>
                                                        </div>

                                                    </div>
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm text-gray-700 relative group">
                                                            Link expiry warnings
                                                            <div class="absolute left-0 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Get notified before referral links expire.
                                                                <div class="absolute -bottom-1 left-4 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </span>
                                                      <div class="relative">
                                                        <input type="hidden" name="link_expire" value="0">
                                                        <input type="checkbox" 
                                                            id="email-expiry" 
                                                            name="link_expire" 
                                                            class="sr-only" 
                                                            value="1"
                                                            <?php echo (isset($final['link_expire']) && $final['link_expire'] == 1) ? 'checked' : ''; ?>>
                                                    </div>

                                                    </div>
                                                </div>
                                            </div>

                                            <div id="system-notifications">
                                                <h4 class="font-medium text-gray-900 mb-3">System Notifications</h4>
                                                <div class="space-y-3">
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm text-gray-700 relative group">
                                                            New rep registrations
                                                            <div class="absolute left-0 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Receive in-app notifications when new reps register.
                                                                <div class="absolute -bottom-1 left-4 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </span>
                                                     <div class="relative">
                                                        <input type="hidden" name="new_rep_registration" value="0">
                                                        <input type="checkbox" 
                                                            id="system-registration" 
                                                            name="new_rep_registration" 
                                                            value="1"
                                                            class="sr-only" 
                                                            <?php echo (isset($final['new_rep_registration']) && $final['new_rep_registration'] == 1) ? 'checked' : ''; ?>>
                                                    </div>

                                                    </div>
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm text-gray-700 relative group">
                                                            Community requests
                                                            <div class="absolute left-0 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Get notified about new community creation requests.
                                                                <div class="absolute -bottom-1 left-4 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </span>
                                                       <div class="relative">
                                                            <input type="hidden" name="community_request" value="0">

                                                        <input type="checkbox" 
                                                            id="system-community" 
                                                            name="community_request" 
                                                            value="1"
                                                            class="sr-only" 
                                                            <?php echo (isset($final['community_request']) && $final['community_request'] == 1) ? 'checked' : ''; ?>>
                                                    </div>

                                                    </div>
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm text-gray-700 relative group">
                                                            Payment processing
                                                            <div class="absolute left-0 bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded-lg py-2 px-3 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none">
                                                                Get notified about commission payment processing status.
                                                                <div class="absolute -bottom-1 left-4 w-2 h-2 bg-gray-900 rotate-45"></div>
                                                            </div>
                                                        </span>
                                                        <div class="relative">
                                                                <input type="hidden" name="payment_process" value="0">

    <input type="checkbox" 
           id="system-payment" 
           value="1"
           name="payment_process" 
           class="sr-only" 
           <?php echo (isset($final['payment_process']) && $final['payment_process'] == 1) ? 'checked' : ''; ?>>
</div>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="settings-notice" class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6">
                                        <div class="flex items-start">
                                            <div class="flex-shrink-0">
                                                <i class="fa-solid fa-info-circle text-primary"></i>
                                            </div>
                                            <div class="ml-3">
                                                <h3 class="text-sm font-medium text-blue-800">Important Note</h3>
                                                <div class="mt-2 text-sm text-blue-700">
                                                    <p>These values apply system-wide but can be overridden per community or individual sales representative. Changes will take effect immediately for new referral links and communities.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Form Buttons -->
                                    <div id="settings-actions" class="flex justify-end space-x-3 mt-6">
                                        <button type="reset" onclick="location.reload();"  class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 font-medium">
                                            Reset to Defaults
                                        </button>
                                        <button type="submit" name="updateCommission" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 font-medium">
                                            Save Settings
                                        </button>
                                    </div>
                                </div>
                            </form>


                            </div>
                        </div>


                        <!-- <div class="">
                            <div class="row">
                                 <div class="col-12">
                                    <div class="search-sec-cmn user-page d-flex align-items-center justify-content- mb-4">
                                        <div class="addUser">
                                            <a href="#" class="btn-primary btn-small" title="Add User" data-bs-toggle="modal" data-bs-target="#addUserModal"><i class="fa fa-plus-circle fa-2x"></i> </a>
                                          </div>
                                        <div class="search-form me-2">
                                            <button class="btn p-0 outline-0" type="submit"><img src="assets/img/list/search.svg" alt="search icon" /></button>
                                            <input type="search" class="form-control form-input border-0" id="searchSalesPerson" placeholder="Search Sales Person.." />
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="list-users table-responsive">
                                        
                                        <table class="table data-table-cmn" id="salesPersonTable">
                                            <thead>
                                                <tr class="table-header">

                                                    <th scope="col" class="userHeading-size">
                                                        USER 
                                                    </th>
                                                    <th scope="col">
                                                        HANDLE 
                                                    </th>
                                                    <th scope="col">
                                                        <a href="#" class="userHeading"> EMAIL </a>
                                                    </th>
                                                    <th scope="col">
                                                        PASSWORD 
                                                    </th>
                                                    <th scope="col">
                                                        <a href="#" class="userHeading"> STATUS </a>
                                                    </th>
                                                    <th scope="col">
                                                        <a href="#" class="userHeading"> JOINED </a>
                                                    </th>
                                                    <th scope="col">
                                                        <div class="userHeading">ACTION</div>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                            </tbody>
                                        </table>
                                        <div id="noDataMessage" class="no-data-container" style="display: none;">
                                            <img src="<?= NO_DATA_IMG ?>" alt="No Data">
                                            <h3><?= NO_DATA_TITLE ?></h3>
                                            <p><?= NO_DATA_DESC ?></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                    </section>
                </main>
            </div>
            <!-- content area end -->
         
            <!-- Add New Rep Modal OLD -->
            <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="addUserLabel">Add New Sales Rep</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form method="post" enctype="multipart/form-data">
                            <div class="modal-body">
                                <div class="image-upload-wrapper d-flex align-items-center mb-4">
                                    <div class="photo-preview rounded-circle bg-light d-flex align-items-center justify-content-center me-3 overflow-hidden" style="width: 64px; height: 64px;">
                                      <img class="preview-image w-16 h-16 rounded-full mr-4" src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg">
                                    </div>
                                    <div>
                                      <button type="button" class="btn btn-outline-secondary btn-sm upload-btn">
                                        <i class="fa-solid fa-upload me-1"></i> Upload Photo
                                      </button>
                                      <input type="file" name="image" accept="image/*" class="photo-input d-none">
                                      <p class="text-muted small mt-1">JPG, PNG or GIF</p>
                                    </div>
                                  </div>
                                  
                                
                    <!-- jsut  -->
                            <div class="row g-4">
                                <div class="col-md-6">
                                <label class="form-label">Full Name <span class="text-danger">*</span></label>
                                <input type="text" name="name" required class="form-control" placeholder="Enter full name">
                                </div>
                                <input type="hidden" name="account_type" id="account_type" value="3">

                                <div class="col-md-6">
                                <label class="form-label">Email <span class="text-danger">*</span></label>
                                <input type="email" name="email" required class="form-control" placeholder="Enter email address">
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label">Password <span class="text-danger">*</span></label>
                                    <input type="password" name="password" required class="form-control" placeholder="Enter your password">
                                    </div>
                                <div class="col-md-6">
                                <label class="form-label">Phone <span class="text-danger">*</span></label>
                                <input type="tel" name="phone" required class="form-control" placeholder="Enter phone number">
                                </div>
                            
                            </div>
                    
                            <div class="mt-4">
                                <label class="form-label">Status</label>
                                <select name="status" class="form-select">
                                    <option value="1" selected>Active</option>
                                    <option value="0">Flagged</option>
                                </select>
                            </div>
                            
                    
                            <div class="mt-4">
                                <label class="form-label">Assign to Communities</label>
                                <select name="community[]" id="community" multiple="multiple" class="form-select mb-2">
                                    <option value="">Select communities to assign</option>
                                    <?php foreach ($communities as $community): ?>
                                        <option value="<?php echo htmlspecialchars($community['name']); ?>">
                                            <?php echo htmlspecialchars($community['name']); ?>
                                        </option>
                                    <?php endforeach; ?>
                                </select>
                                
                            </div>
                            </div>
                    
                            <div class="modal-footer">
                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" name="addUser" class="btn btn-primary">Create Rep</button>
                            </div>
                    </form>
                </div>
                </div>
            </div>
            <!-- MODAL EDIT PASSWORD -->
            <div class="modal fade customModal" id="editUserModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Change Password</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">

                                <div>
                                    <input type="text" name="up_password" id="" placeholder="Reset Password..." class="form-control m-0" value="" required />
                                </div>

                                <div class="mt-2 gap-3 d-flex flex-row">
                                    <button type="submit" name="addxsUser" class="btn btnSave">Save</button>
                                    <button data-bs-dismiss="modal" type="button" class="btn btnClose">Close</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- Sales Reps Modals -->
            <!-- ========================================== -->
            <!-- VIEW REP DETAILS MODAL -->
            <div class="modal fade customModal" id="viewRepDetailsModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Sales Rep Details</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">

                                <div class="">
                                    <div class="flex flex-col md:flex-row md:items-start mb-8">
                                        <div class="flex-shrink-0 mb-4 md:mb-0 md:mr-6">
                                            <img id="viewImg" src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-24 h-24 rounded-full border-4 border-white shadow-md">
                                        </div>
                                        <div class="flex-1">
                                            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                                                <div>
                                                    <h4 class="text-2xl font-semibold text-gray-900" id="viewName">John Smith</h4>
                                                    <p class="text-gray-500" id="viewId">Sales Representative ID: SR001</p>
                                                    <div class="flex items-center mt-2 space-x-2">
                                                        <span id="viewStatus" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                            <i class="fa-solid fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                                                            Active
                                                        </span>
                                                        <span class="text-sm text-gray-500" id="viewCreated">Since: Jan 15, 2024</span>
                                                    </div>
                                                </div>
                                                <div class="mt-4 md:mt-0 flex space-x-2">
                                                    <button type="button" id="viewEedit" data-bs-toggle="modal" data-bs-target="#editRepInfoModal" class="px-3 py-1.5 border border-gray-300 rounded-md text-sm text-gray-700 hover:bg-gray-50 editReps" >
                                                        <i class="fa-solid fa-pen mr-1"></i> Edit
                                                    </button>
                                                 
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                        <div id="contact-info-section">
                                            <h5 class="font-medium text-gray-900 mb-3 flex items-center">
                                                <i class="fa-solid fa-address-card text-primary mr-2"></i> Contact Information
                                            </h5>
                                            <div class="bg-gray-50 rounded-lg p-4">
                                                <div class="flex items-start mb-3">
                                                    <i class="fa-solid fa-envelope text-gray-400 mt-1 mr-3"></i>
                                                    <div>
                                                        <p class="text-sm text-gray-900" id="viewEmail">john.smith@email.com</p>
                                                        <p class="text-xs text-gray-500" >Primary Email</p>
                                                    </div>
                                                </div>
                                                <div class="flex items-start">
                                                    <i class="fa-solid fa-phone text-gray-400 mt-1 mr-3"></i>
                                                    <div>
                                                        <p class="text-sm text-gray-900" id="viewPhone">+1 (555) 123-4567</p>
                                                        <p class="text-xs text-gray-500">Mobile</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="assigned-communities-section">
                                            <h5 class="font-medium text-gray-900 mb-3 flex items-center">
                                                <i class="fa-solid fa-building-user text-primary mr-2"></i> Assigned Communities
                                            </h5>
                                            <div class="bg-gray-50 rounded-lg p-4">
                                                <div class="flex flex-wrap gap-2" id="viewCommunity">
                                                  
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="ads-breakdown-section" class="mb-8">
                                        <h5 class="font-medium text-gray-900 mb-3 flex items-center">
                                            <i class="fa-solid fa-chart-pie text-primary mr-2"></i> Ads Breakdown
                                        </h5>
                                        <div class="bg-gray-50 rounded-lg p-4">
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <div class="bg-white p-4 rounded-lg shadow-sm">
                                                    <div class="flex items-center justify-between">
                                                        <p class="text-sm text-gray-500">Total Ads</p>
                                                        <span class="text-xs font-medium text-gray-400">All Time</span>
                                                    </div>
                                                    <div class="flex items-end mt-1">
                                                        <p class="text-2xl font-semibold text-gray-900" id="view-total-ad">245</p>
                                                        <span class="ml-2 text-xs font-medium text-green-500 flex items-center">
                                                            <i class="fa-solid fa-arrow-up mr-1"></i> 12% 
                                                        </span>
                                                    </div>
                                                    <div class="mt-2 h-1 w-full bg-gray-100 rounded-full overflow-hidden">
                                                        <div class="bg-primary h-full rounded-full" style="width: 12%"></div>
                                                    </div>
                                                </div>
                                                <div class="bg-white p-4 rounded-lg shadow-sm">
                                                    <div class="flex items-center justify-between">
                                                        <p class="text-sm text-gray-500">Referral Ads</p>
                                                        <span class="text-xs font-medium text-gray-400">All Time</span>
                                                    </div>
                                                    <div class="flex items-end mt-1">
                                                        <p class="text-2xl font-semibold text-gray-900" id="view-total-referral">180</p>
                                                        <span class="ml-2 text-xs font-medium text-green-500 flex items-center">
                                                            <i class="fa-solid fa-arrow-up mr-1"></i> 8%
                                                        </span>
                                                    </div>
                                                    <div class="mt-2 h-1 w-full bg-gray-100 rounded-full overflow-hidden">
                                                        <div class="bg-blue-400 h-full rounded-full" style="width: 8.5%"></div>
                                                    </div>
                                                </div>
                                                <div class="bg-white p-4 rounded-lg shadow-sm">
                                                    <div class="flex items-center justify-between">
                                                        <p class="text-sm text-gray-500">Community Ads</p>
                                                        <span class="text-xs font-medium text-gray-400">All Time</span>
                                                    </div>
                                                    <div class="flex items-end mt-1">
                                                        <p class="text-2xl font-semibold text-gray-900" id="view-total-community">65</p>
                                                        <span class="ml-2 text-xs font-medium text-green-500 flex items-center">
                                                            <i class="fa-solid fa-arrow-up mr-1"></i> 15%
                                                        </span>
                                                    </div>
                                                    <div class="mt-2 h-1 w-full bg-gray-100 rounded-full overflow-hidden">
                                                        <div class="bg-indigo-400 h-full rounded-full" style="width: 15.5%"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div id="earnings-section" class="mb-8">
                                        <h5 class="font-medium text-gray-900 mb-3 flex items-center">
                                            <i class="fa-solid fa-dollar-sign text-primary mr-2"></i> Earnings
                                        </h5>
                                        <div class="bg-gray-50 rounded-lg p-4">
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                                <div class="bg-white p-4 rounded-lg shadow-sm">
                                                    <div class="flex items-center justify-between">
                                                        <p class="text-sm text-gray-500">Lifetime Earnings</p>
                                                        <span class="text-xs font-medium text-gray-400" id="view-year-text">Since Jan 2024</span>
                                                    </div>
                                                    <div class="flex items-end mt-1">
                                                        <p class="text-2xl font-semibold text-gray-900" id="view-total-earning">$12,450</p>
                                                        <span class="ml-2 text-xs font-medium text-green-500 flex items-center">
                                                            <i class="fa-solid fa-arrow-up mr-1"></i> 18%
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="bg-white p-4 rounded-lg shadow-sm">
                                                    <div class="flex items-center justify-between">
                                                        <p class="text-sm text-gray-500">This Month</p>
                                                        <span class="text-xs font-medium text-gray-400" id="view-this-month-text">Dec 2024</span>
                                                    </div>
                                                    <div class="flex items-end mt-1">
                                                        <p class="text-2xl font-semibold text-gray-900" id="view-this-month">$2,340</p>
                                                        <span class="ml-2 text-xs font-medium text-green-500 flex items-center">
                                                            <i class="fa-solid fa-arrow-up mr-1"></i> 5%
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- <div id="earnings-chart" class="h-64 bg-white p-4 rounded-lg shadow-sm"></div> -->
                                        </div>
                                    </div>

                                    <!-- <div id="activity-section">
                                        <h5 class="font-medium text-gray-900 mb-3 flex items-center">
                                            <i class="fa-solid fa-clock-rotate-left text-primary mr-2"></i> Recent Activity
                                        </h5>
                                        <div class="bg-gray-50 rounded-lg p-4">
                                            <div class="space-y-4">
                                                <div class="flex items-start">
                                                    <div class="flex-shrink-0 h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center mr-3">
                                                        <i class="fa-solid fa-ad text-blue-500 text-xs"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <p class="text-sm text-gray-900 font-medium">Added 3 new community ads</p>
                                                        <p class="text-xs text-gray-500 mt-1">2 hours ago - Oakwood Heights</p>
                                                    </div>
                                                </div>
                                                <div class="flex items-start">
                                                    <div class="flex-shrink-0 h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center mr-3">
                                                        <i class="fa-solid fa-link text-indigo-500 text-xs"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <p class="text-sm text-gray-900 font-medium">Created 5 new referral links</p>
                                                        <p class="text-xs text-gray-500 mt-1">Yesterday at 4:30 PM</p>
                                                    </div>
                                                </div>
                                                <div class="flex items-start">
                                                    <div class="flex-shrink-0 h-8 w-8 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                                        <i class="fa-solid fa-building text-green-500 text-xs"></i>
                                                    </div>
                                                    <div class="flex-1">
                                                        <p class="text-sm text-gray-900 font-medium">Assigned to Riverside Manor community</p>
                                                        <p class="text-xs text-gray-500 mt-1">Dec 12, 2024</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->
                                </div>

                                <div class="mt-2 gap-3 d-flex flex-row">
                                    <button type="submit" name="exportData" class="btn btnSave">Export Data</button>
                                    <button data-bs-dismiss="modal" type="button" class="btn btnClose">Close</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--DELETE MODAL -->
            <div class="modal fade customModal" id="deleteRepModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Delete SROO4?</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="flex items-center justify-center">
                                    <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center">
                                        <i class="fa-solid fa-trash text-red-500 text-xl"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="text-center text-gray-600 mb-6">This will permanently delete this rep. This action cannot be undone. Are you sure?</p>
                                </div>

                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="cc" class="btn btnSave">Delete</button>
                                    <button type="button" data-bs-dismiss="modal" class="btn btnClose">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--SUSPEND MODAL -->
            <div class="modal fade customModal" id="suspendRepModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Suspend Rep?</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="flex items-center justify-center">
                                    <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center">
                                        <i class="fa-solid fa-user-slash text-red-500 text-xl"></i>
                                    </div>
                                </div>
                                <p class="text-center text-gray-600 mb-6">Are you sure you want to suspend this sales rep? They will no longer be able to access their account or manage ads.</p>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="fff" class="btn btnSave">Suspend</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--Assign to Community MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="assignToCommunityModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Assign to Community</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div class="">
                                        <div class="flex items-center mb-4">
                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-10 h-10 rounded-full mr-3">
                                            <div>
                                                <div class="font-medium text-gray-900">John Smith</div>
                                                <div class="text-sm text-gray-500">ID: SR001</div>
                                            </div>
                                        </div>
                                        
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Select Community</label>
                                        <div class="relative mb-4">
                                            <input type="text" placeholder="Search communities..." class="w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                                                <i class="fa-solid fa-search text-gray-400"></i>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-gray-50 rounded-lg p-3 max-h-40 overflow-y-auto mb-4">
                                            <div class="space-y-2">
                                                <label class="flex items-center p-2 hover:bg-gray-100 rounded-md">
                                                    <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                                    <span class="ml-2 text-sm text-gray-700">Meadow Creek</span>
                                                </label>
                                                <label class="flex items-center p-2 hover:bg-gray-100 rounded-md">
                                                    <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                                    <span class="ml-2 text-sm text-gray-700">Highland Terrace</span>
                                                </label>
                                                <label class="flex items-center p-2 hover:bg-gray-100 rounded-md">
                                                    <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                                    <span class="ml-2 text-sm text-gray-700">Sunset Villas</span>
                                                </label>
                                                <label class="flex items-center p-2 hover:bg-gray-100 rounded-md">
                                                    <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                                    <span class="ml-2 text-sm text-gray-700">Cedar Ridge</span>
                                                </label>
                                                <label class="flex items-center p-2 hover:bg-gray-100 rounded-md">
                                                    <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                                    <span class="ml-2 text-sm text-gray-700">Willow Park</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-6">
                                        <h4 class="text-sm font-medium text-gray-700 mb-2">Currently Assigned</h4>
                                        <div class="bg-gray-50 rounded-lg p-3">
                                            <div class="flex flex-wrap gap-2">
                                                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                    Oakwood Heights
                                                    <button class="ml-1 text-blue-600 hover:text-blue-800">
                                                        <i class="fa-solid fa-times"></i>
                                                    </button>
                                                </span>
                                                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                    Riverside Manor
                                                    <button class="ml-1 text-blue-600 hover:text-blue-800">
                                                        <i class="fa-solid fa-times"></i>
                                                    </button>
                                                </span>
                                                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                    Pine Valley
                                                    <button class="ml-1 text-blue-600 hover:text-blue-800">
                                                        <i class="fa-solid fa-times"></i>
                                                    </button>
                                                </span>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <label class="flex items-center">
                                            <input type="checkbox" class="rounded text-primary focus:ring-primary  set-width-30-checkbox">
                                            <span class="ml-2 text-sm text-gray-700">Notify Rep about new assignments</span>
                                        </label>
                                        <p class="text-xs text-gray-500 mt-1 ml-6">An email will be sent to the rep with details about their new community assignments</p>
                                    </div>
                                </div>

                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Assign</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
           
            <!--EDIT REP INFO MODAL -->
            <div class="modal fade customModal" id="editRepInfoModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Edit Sales Rep</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">


                                    <div class="d-flex align-items-center mb-4">
                                        <div id="photoPreviewEdit" class="rounded-circle bg-light d-flex align-items-center justify-content-center me-3 overflow-hidden" style="width: 64px; height: 64px;">
                                            <img id="image" src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-16 h-16 rounded-full mr-4">
                                        </div>
                                        <div>
                                        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="document.getElementById('photoInputEdit').click()">
                                            <i class="fa-solid fa-upload me-1"></i> Upload Photo
                                        </button>
                                        <input type="file" name="image" id="photoInputEdit" accept="image/*" class="d-none" onchange="previewImage2(event)">
                                        <p class="text-muted small mt-1">JPG, PNG or GIF</p>
                                        </div>
                                    </div>


                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Full Name <span class="text-red-500">*</span></label>
                                            <input type="text" name="name" id="editName" value="John Smith" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Email <span class="text-red-500">*</span></label>
                                            <input type="email" name="email" id="editEmail" value="john.smith@email.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone <span class="text-red-500">*</span></label>
                                            <input type="tel" name="phone" id="editTel" value="+1 (555) 123-4567" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                            <div class="relative">
                                                <select name="status" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none appearance-none h-auto">
                                                    <option value="1" selected>Active</option>
                                                    <option value="0">Flagged</option>
                                                </select>
                                                
                                            </div>
                                        </div>
                                    </div>
                                    <input type="hidden" name="id" id="h_id">

                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Assigned Communities</label>
                                        <div class="relative">
                                            <select name="community[]" id="editCommunity" multiple="multiple" class="form-select mb-2">
                                                <option value="">Select communities to assign</option>
                                                <?php foreach ($communities as $community): ?>
                                                    <option value="<?php echo htmlspecialchars($community['name']); ?>">
                                                        <?php echo htmlspecialchars($community['name']); ?>
                                                    </option>
                                                <?php endforeach; ?>
                                            </select>
                                           
                                        </div>
                                       
                                    </div>

                               
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="editUser" class="btn btnSave">Save Changes</button>
                                    <button type="button" data-bs-dismiss="modal" class="btn btnClose">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- OFFCANVAS FILTER PANEL -->
            <div class="offcanvas offcanvas-end set-modal-assign-community customModal" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
                <div class="modal-header p-3">
                    <h2 class="modal-title fs-5" id="addUserLabel">Edit Sales Rep</h2>
                </div>
                <div class="offcanvas-body">
                    <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                        <div class="overflow-y-auto flex-grow">
                            <div class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Status</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" checked="" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Active</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Flagged</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Suspended</span>
                                    </label>
                                </div>
                            </div>

                            <div class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Activity Range</h4>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none mb-3 h-auto">
                                    <option>Last 7 days</option>
                                    <option>Last 30 days</option>
                                    <option>Last 90 days</option>
                                    <option>Custom range</option>
                                </select>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">From</label>
                                        <input type="date" class="w-full px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">To</label>
                                        <input type="date" class="w-full px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                    </div>
                                </div>
                            </div>

                            <div class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Ads Count</h4>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">Min</label>
                                        <input type="number" placeholder="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">Max</label>
                                        <input type="number" placeholder="1000+" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                    </div>
                                </div>
                            </div>

                            <div class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Earnings Range</h4>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">Min ($)</label>
                                        <input type="number" placeholder="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">Max ($)</label>
                                        <input type="number" placeholder="50000+" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none">
                                    </div>
                                </div>
                            </div>

                            <div class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Communities</h4>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none h-auto">
                                    <option>All Communities</option>
                                    <option>Oakwood Heights</option>
                                    <option>Riverside Manor</option>
                                    <option>Pine Valley</option>
                                    <option>Meadow Creek</option>
                                </select>
                            </div>

                            <div class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Sort By</h4>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none h-auto">
                                    <option>Highest Ads Count</option>
                                    <option>Lowest Ads Count</option>
                                    <option>Highest Earnings</option>
                                    <option>Lowest Earnings</option>
                                    <option>Most Recent Activity</option>
                                    <option>Oldest Activity</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-2 gap-3 d-flex flex-row justify-center">
                            <button type="submit" name="addUser" class="btn btnSave">Apply Filters</button>
                            <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Reset Filters</button></a>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- ========================================== -->
            <!-- Communities Modals -->
            <!-- ========================================== -->
            <!--DELETE COMMUNITY CONFIRMATION MODAL -->
            <div class="modal fade customModal" id="deletecommunityModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Delete Community?</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="flex items-center justify-center">
                                    <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center">
                                        <i class="fa-solid fa-trash text-red-500 text-xl"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="text-center text-gray-600 mb-6">This action is permanent and will remove the community from the platform. This community has no members or posts.</p>
                                </div>

                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Delete</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--Reactivate COMMUNITY MODAL -->
            <div class="modal fade customModal" id="reactivateCommunityModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Reactivate Community?</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="flex items-center justify-center">
                                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                        <i class="fa-solid fa-check text-green-500 text-xl"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="text-center text-gray-600 mb-6">Are you sure you want to reactivate 'Design Hub'? This will restore all community activities and notify members.</p>
                                </div>

                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Reactivate Community</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--SUSPEND COMMUNITY MODAL -->
            <div class="modal fade customModal" id="suspendCommunityModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Suspend Community?</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="flex items-center justify-center">
                                    <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center">
                                        <i class="fa-solid fa-user-slash text-red-500 text-xl"></i>
                                    </div>
                                </div>
                                <p class="text-center text-gray-600 mb-6">Are you sure you want to suspend 'Marketing Pros'? This will temporarily restrict all activities and notify members.</p>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Suspend Community</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--FLAG COMMUNITY MODAL -->
            <div class="modal fade customModal" id="flagCommunityModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Flag Community?</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="flex items-center justify-center">
                                    <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center">
                                        <i class="fa-solid fa-flag text-yellow-500 text-xl"></i>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-600 text-center mb-6">Are you sure you want to flag 'Marketing Pros'? This may restrict visibility and notify the owner of potential content issues.</p>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Flag Community</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--ADD COMMUNITY MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="addCommunityModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Add New Community</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">

                                    <div class="image-upload-wrapper d-flex align-items-center mb-4">
                                        <div class="photo-preview rounded-circle bg-light d-flex align-items-center justify-content-center me-3 overflow-hidden" style="width: 64px; height: 64px;">
                                          <img class="preview-image w-16 h-16 rounded-full mr-4" src="././assets/img/Avatar.png">
                                        </div>
                                        <div>
                                          <button type="button" class="btn btn-outline-secondary btn-sm upload-btn">
                                            <i class="fa-solid fa-upload me-1"></i> Upload Photo
                                          </button>
                                          <input type="file" name="image" accept="image/*" class="photo-input d-none">
                                          <p class="text-muted small mt-1">JPG, PNG or GIF</p>
                                        </div>
                                      </div>
                                      
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Community Name <span class="text-danger">*</span></label>
                                        <input type="text" name="name" required placeholder="Enter community name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Owner <span class="text-danger">*</span></label>
                                        <div class="relative">
                                            <select required name="user_id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent appearance-none h-auto">
                                                <option value="">Select a rep...</option>
                                                <?php foreach($salesPerson as $k => $v) { ?>
                                                <option value="<?php echo $v['id'];?>"><?php echo $v['name'];?> (SR<?php echo $v['id'];?>)</option>
                                                <?php } ?>
                                            </select>
                                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                                <i class="fa-solid fa-chevron-down text-xs"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Privacy</label>
                                        <div class="flex items-center space-x-6 mt-1">
                                            <label class="flex items-center">
                                                <input type="radio" value="0" name="is_private" checked class="w-4 h-4 text-primary focus:ring-primary">
                                                <span class="ml-2 text-sm text-gray-700">Public</span>
                                                <span class="ml-1 text-xs text-gray-500">(Visible to all)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" value="1" name="is_private" class="w-4 h-4 text-primary focus:ring-primary">
                                                <span class="ml-2 text-sm text-gray-700">Private</span>
                                                <span class="ml-1 text-xs text-gray-500">(Invite only)</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                                        <div class="flex items-center">
                                            <input type="text" name="address" id="address" placeholder="Address" required oninput="initAutocomplete()" autocomplete="off" class="form-control m-0" required />
                                            <input type="hidden" name="latitude" id="latitude">
                                            <input type="hidden" name="longitude" id="longitude">
                                            <input type="hidden" name="city" id="city">
                                            <input type="hidden" name="state" id="state">
                                            <input type="hidden" name="country_code" id="country_code">
                                            <input type="hidden" name="account_type" value="3">
                                        </div>
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                        <textarea name="description" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-24" placeholder="Enter community description..."></textarea>
                                    </div>
                                    
                                 
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addSalesCommunity" class="btn btnSave">Create Community</button>
                                    <button type="button" data-bs-dismiss="modal" class="btn btnClose">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--TRANSFER OWNERSHIP MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="transferOwnershipModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Transfer Community Ownership</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div class="mb-2">
                                        <p class="text-sm text-gray-700">You are transferring ownership of <span class="font-medium">Tech Enthusiasts</span> community to another rep.</p>
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Current Owner</label>
                                        <div class="flex items-center bg-gray-50 p-3 rounded-lg">
                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-8 h-8 rounded-full mr-3">
                                            <div>
                                                <p class="text-sm font-medium text-gray-900">John Smith</p>
                                                <p class="text-xs text-gray-500">ID: SR001</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">New Owner</label>
                                        <div class="relative">
                                            <div class="relative set-input-h-auto set-input-search-icon">
                                                <input type="text" placeholder="Search for a rep..." class="w-full px-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                                <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            </div>
                                            <div class="mt-2 bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                                <div class="max-h-40 overflow-y-auto">
                                                    <div class="hover:bg-gray-50 cursor-pointer p-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-5.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Sarah Johnson</p>
                                                                <p class="text-xs text-gray-500">ID: SR002</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="hover:bg-gray-50 cursor-pointer p-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-3.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Mike Wilson</p>
                                                                <p class="text-xs text-gray-500">ID: SR003</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="hover:bg-gray-50 cursor-pointer p-2">
                                                        <div class="flex items-center">
                                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-6.jpg" class="w-6 h-6 rounded-full mr-2">
                                                            <div>
                                                                <p class="text-sm font-medium text-gray-900">Emily Chen</p>
                                                                <p class="text-xs text-gray-500">ID: SR004</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Note (Optional)</label>
                                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-20" placeholder="Add a note about this transfer..."></textarea>
                                    </div>

                                    <div class="mt-2 bg-yellow-50 border border-yellow-100 rounded-lg p-3">
                                        <div class="flex items-start">
                                            <i class="fa-solid fa-circle-info text-yellow-500 mt-0.5 mr-2"></i>
                                            <div class="text-sm text-yellow-700">
                                                <p class="font-medium mb-1">Important information about ownership transfer</p>
                                                <ul class="list-disc pl-5 space-y-1">
                                                    <li>The new owner will have full control over the community</li>
                                                    <li>They will receive all commission payments going forward</li>
                                                    <li>All members will be notified of the ownership change</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Confirm Transfer</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--EDIT COMMUNITY MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="editCommunityModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Edit Community Settings</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                  

                                    <div class="image-upload-wrapper d-flex align-items-center mb-4">
                                        <div class="photo-preview rounded-circle bg-light d-flex align-items-center justify-content-center me-3 overflow-hidden" style="width: 64px; height: 64px;">
                                          <img class="preview-image w-16 h-16 rounded-full mr-4" src="././assets/img/Avatar.png">
                                        </div>
                                        <div>
                                          <button type="button" class="btn btn-outline-secondary btn-sm upload-btn">
                                            <i class="fa-solid fa-upload me-1"></i> Upload Photo
                                          </button>
                                          <input type="file" name="image" accept="image/*" class="photo-input d-none">
                                          <p class="text-muted small mt-1">JPG, PNG or GIF</p>
                                        </div>
                                      </div>

                                    <input type="hidden" name="id" id="comId">
                                    
                                    <div class="mb-2  set-input-h-auto">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Community Name</label>
                                        <input type="text" name="name" id="editCommunityName" value="Tech Enthusiasts" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Privacy</label>
                                        <div class="flex items-center space-x-4">
                                            <label class="flex items-center">
                                                <input type="radio" name="is_private" value="0"  class="w-4 h-4 text-primary focus:ring-primary">
                                                <span class="ml-2 text-sm text-gray-700">Public</span>
                                                <span class="ml-1 text-xs text-gray-500">(visible to all users)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="is_private" value="1" class="w-4 h-4 text-primary focus:ring-primary">
                                                <span class="ml-2 text-sm text-gray-700">Private</span>
                                                <span class="ml-1 text-xs text-gray-500">(invitation only)</span>
                                            </label>
                                        </div>
                                    </div>

                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Owner <span class="text-danger">*</span></label>
                                        <div class="relative">
                                            <select required name="user_id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent appearance-none h-auto">
                                                <option value="">Select a rep...</option>
                                                <?php foreach($salesPerson as $k => $v) { ?>
                                                <option value="<?php echo $v['id'];?>"><?php echo $v['name'];?> (SR<?php echo $v['id'];?>)</option>
                                                <?php } ?>
                                            </select>
                                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                                <i class="fa-solid fa-chevron-down text-xs"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                        <select name="status" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-auto">
                                            <option selected value="1">Active</option>
                                            <option value="0">Flagged</option>
                                            
                                        </select>
                                        <p class="mt-1 text-xs text-gray-500">Changing status will affect visibility and member access</p>
                                    </div>
                                    
                              
                                    
                                    <div class="mb-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                        <textarea name="description" id="editComunityDescription" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-24">A community for tech enthusiasts to share ideas, discuss new technologies, and collaborate on projects. Members can join discussions, participate in weekly challenges, and connect with like-minded individuals.</textarea>
                                    </div>
                                    
                    
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="editSaleCommunity" class="btn btnSave">Save Changes</button>
                                    <button type="button" class="btn btnClose" data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--VIEW COMMUNITY DETAILS COMMUNITY MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="viewCommunityDetailsModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Community Details</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div class="flex items-center mb-2">
                                        <div class="w-16 h-16 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                                            <img id="comImg" src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-8 h-8 rounded-full mr-2">
                                        </div>
                                        <div>
                                            <h4 class="text-xl font-semibold text-gray-900" id="communityName">Tech Enthusiasts</h4>
                                            <p class="text-sm text-gray-500" id="communityId">ID: COM001</p>
                                        </div>
                                    </div>

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-2">
                                        <div>
                                            <h5 class="text-sm font-medium text-gray-500 mb-2">Owner</h5>
                                            <div class="flex items-center">
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900" id="ownerName">John Smith</p>
                                                    <p class="text-xs text-gray-500" id="ownerId">ID: SR001</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <h5 class="text-sm font-medium text-gray-500 mb-2">Privacy Status</h5>
                                            <span class="inline-flex items-center px-2.5 py-1 rounded-md text-sm font-medium bg-green-100 text-green-800" id="privacyStatus">
                                                <i class="fa-solid fa-globe mr-1"></i>
                                                Public
                                            </span>
                                        </div>
                                        <div>
                                            <h5 class="text-sm font-medium text-gray-500 mb-2">Status</h5>
                                            <span class="inline-flex items-center px-2.5 py-1 rounded-md text-sm font-medium bg-green-100 text-green-800" id="communityStatus">
                                                <i class="fa-solid fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                                                Active
                                            </span>
                                        </div>
                                        <div>
                                            <h5 class="text-sm font-medium text-gray-500 mb-2">Members</h5>
                                            <p class="text-sm font-medium text-gray-900" id="memberCount">1,247 members</p>
                                        </div>
                                        
                                        <div>
                                            <h5 class="text-sm font-medium text-gray-500 mb-2">Created</h5>
                                            <p class="text-sm font-medium text-gray-900" id="createdAt">October 12, 2023</p>
                                        </div>
                                        <div>
                                            <h5 class="text-sm font-medium text-gray-500 mb-2">Last Activity</h5>
                                            <p class="text-sm font-medium text-gray-900" id="lastActivity">3 hours ago</p>
                                    
                                        </div>
                                    </div>

                                    <div class="mb-2">
                                        <h5 class="text-sm font-medium text-gray-500 mb-2">Description</h5>
                                        <p class="text-sm text-gray-700 bg-gray-50 p-4 rounded-lg" id="description">
                                            A community for tech enthusiasts to share ideas, discuss new technologies, and collaborate on projects. Members can join discussions, participate in weekly challenges, and connect with like-minded individuals.
                                        </p>
                                    </div>

                                    <div class="border-t border-gray-200 pt-3">
                                        <h5 class="text-sm font-medium text-gray-700 mb-4">Activity Summary</h5>
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <div class="bg-gray-50 p-4 rounded-lg">
                                                <div class="flex items-center justify-between mb-2">
                                                    <span class="text-xs font-medium text-gray-500">Posts This Week</span>
                                                    <span class="text-xs text-success" id="post_growth_percentage">+12%</span>
                                                </div>
                                                <p class="text-lg font-semibold text-gray-900" id="posts_this_week">124</p>
                                            </div>
                                            <div class="bg-gray-50 p-4 rounded-lg">
                                                <div class="flex items-center justify-between mb-2">
                                                    <span class="text-xs font-medium text-gray-500">New Referrals</span>
                                                    <span class="text-xs text-success" id="referral_growth_percentage">+8%</span>
                                                </div>
                                                <p class="text-lg font-semibold text-gray-900" id="referrals_this_week">36</p>
                                            </div>
                                            <div class="bg-gray-50 p-4 rounded-lg">
                                                <div class="flex items-center justify-between mb-2">
                                                    <span class="text-xs font-medium text-gray-500">Engagement Rate</span>
                                                    <span class="text-xs text-success" id="engagement_rate_growth_percentage">+5%</span>
                                                </div>
                                                <p class="text-lg font-semibold text-gray-900" id="engagement_rate_this_week">68%</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="button" name="exportCommunity" class="btn btnSave editCom" id="viewEditCom" data-bs-toggle="modal" data-bs-target="#editCommunityModal"><i class="fa-solid fa-pen-to-square mr-2"></i>Edit</button>
                                    <button type="button" data-bs-dismiss="modal" class="btn btnClose">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- OFFCANVAS COMMUNITY FILTER PANEL -->
            <div class="offcanvas offcanvas-end set-modal-assign-community customModal" tabindex="-1" id="communityFilterOffCanvas" aria-labelledby="offcanvasRightLabel">
                <div class="modal-header p-3">
                    <h2 class="modal-title fs-5" id="addUserLabel">Filter Communities</h2>
                </div>
                <div class="offcanvas-body">
                    <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                        <div class="overflow-y-auto flex-grow">
                            <div class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Status</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" checked="" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Active</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Flagged</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded text-primary focus:ring-primary set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Suspended</span>
                                    </label>
                                </div>
                            </div>

                            <div id="filter-privacy" class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Privacy</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" checked="" class="w-4 h-4 text-primary focus:ring-primary rounded set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Public</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" checked="" class="w-4 h-4 text-primary focus:ring-primary rounded set-width-30-checkbox">
                                        <span class="ml-2 text-sm text-gray-700">Private</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div id="filter-commission" class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Commission Rate Range</h4>
                                <div class="flex items-center space-x-2">
                                    <input type="number" placeholder="Min" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <span class="text-gray-500">to</span>
                                    <input type="number" placeholder="Max" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <span class="text-gray-500">%</span>
                                </div>
                            </div>
                            
                            <div id="filter-members" class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Members Count</h4>
                                <div class="flex items-center space-x-2">
                                    <input type="number" placeholder="Min" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <span class="text-gray-500">to</span>
                                    <input type="number" placeholder="Max" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                </div>
                            </div>
                            
                            <div id="filter-sort" class="mb-6">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Sort By</h4>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-auto">
                                    <option>Members (High to Low)</option>
                                    <option>Members (Low to High)</option>
                                    <option>Last Activity (Recent First)</option>
                                    <option>Last Activity (Oldest First)</option>
                                    <option>Commission Rate (High to Low)</option>
                                    <option>Commission Rate (Low to High)</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-2 gap-3 d-flex flex-row justify-center">
                            <button type="submit" name="editqqUser" class="btn btnSave">Apply Filters</button>
                            <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Reset Filters</button></a>
                        </div>
                    </form>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- Referral Links Modals -->
            <!-- ========================================== -->
            <!--CREATE NEW REFERRAL LINK MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="createNewReferralLinkModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Create New Referral Link</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Select Post</label>
                                       <!-- Search Input -->
                                        <div class="relative mb-2 set-input-h-auto set-input-search-icon">
                                            <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" id="searchInput" placeholder="Search posts..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                        </div>
                                        <div class="border border-gray-200 rounded-lg p-2 max-h-60 overflow-y-auto">
                                            <?php foreach ($postData as $post): ?>
                                            <?php
                                                $isSelected = isset($selectedPostId) && $selectedPostId == $post->id;
                                                $image = !empty($post['post_images'][0]['image'])
                                                    ? MEDIA_BASE_URL . $post['post_images'][0]['image']
                                                    : 'assets/default-placeholder.png';
                                            ?>
                                            
                                            <div id= "<?php echo  $post['id']; ?>" data-title="<?= strtolower($post['company']); ?>" class="post-item p-2 cursor-pointer border border-gray-200  rounded-lg mb-2" onclick="selectPost(this)">
                                                <div class="flex items-start">
                                                    <div class="bg-gray-100 rounded-lg w-16 h-16 flex-shrink-0 mr-3 overflow-hidden">
                                                        <img src="<?= $image ?>" alt="<?php echo  $post['title']; ?>" class="w-full h-full object-cover">
                                                    </div>
                                                    <div class="flex-grow">
                                                        <p class="text-sm font-medium text-gray-900"><?= htmlspecialchars($post['company']) ?></p>
                                                        <p class="text-xs text-gray-500 mb-1"><?= $post['title'] ?? 'General' ?></p>
                                                        <p class="text-xs text-gray-500">Post ID: POST-<?php echo $post['id']; ?></p>
                                                    </div>
                                                    <div class="flex-shrink-0 check-icon hidden">
                                                        <i class="fa-solid fa-check-circle text-primary text-lg"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        <?php endforeach; ?>

                                                                                
                                        </div>
                                    </div>
                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Assign Sales Rep</label>
                                        <div class="relative">
                                            <select name="user_id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent appearance-none pr-10 h-auto">
                                                <option value="">Select a rep...</option>
                                                <?php foreach($salesPerson as $k => $v) { ?>
                                                <option value="<?php echo $v['id'];?>"><?php echo $v['name'];?> (SR<?php echo $v['id'];?>)</option>
                                                <?php } ?>
                                            </select>
                                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                                <i class="fa-solid fa-chevron-down text-gray-400"></i>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mt-6">
                                        <label class="form-label">Link Type</label>
                                        <div class="relative">
                                            <select name="link_type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent appearance-none pr-10 h-auto">
                                                <option value="" selected>Select Type</option>
                                                <option value="1" >Create a AD</option>
                                                <option value="0">Post Convert To AD</option>
                                            </select>
                                        </div>
                                        </div>
                                    </div>

                                    <input name="post_id" type="hidden" id="post_id">
                                   
                                    <div class="mb-6">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Optional Notes</label>
                                        <textarea name="info" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" rows="3" placeholder="Add notes about this referral link..."></textarea>
                                    </div>
                                    <div class="mb-6">
                                        <div id="preview-box">
                                          <!-- Dynamically injected content -->
                                        </div>
                                      </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addLink" class="btn btnSave">Create Link</button>
                                    <button type="button" class="btn btnClose" data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--Disable this Referral Link MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="disableReferralLinkModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Disable this Referral Link?</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div id="warning-message" class="flex items-center mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                        <div class="flex-shrink-0 mr-3">
                                            <i class="fa-solid fa-triangle-exclamation text-yellow-500 text-xl"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-sm text-gray-700 font-medium mb-1">Warning: This action cannot be undone</p>
                                            <p class="text-sm text-gray-600">Disabling this link will prevent future referrals. All past data will remain visible in reports.</p>
                                        </div>
                                    </div>
                                    
                                    <div id="link-details" class="mb-6">
                                        <div class="flex items-center justify-between mb-4">
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-500 mb-1">Link ID</h4>
                                                <code class="text-sm font-mono bg-gray-100 px-3 py-1.5 rounded">REF-4A7B</code>
                                            </div>
                                            <div class="text-right">
                                                <h4 class="text-sm font-medium text-gray-500 mb-1">Current Status</h4>
                                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                                    <i class="fa-solid fa-circle text-green-400 mr-1" style="font-size: 6px;"></i>
                                                    Active
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div class="flex items-center mb-4">
                                            <div class="flex-shrink-0 mr-3">
                                                <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-10 h-10 rounded-full">
                                            </div>
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-500 mb-1">Assigned to</h4>
                                                <p class="text-sm font-medium text-gray-900">John Smith</p>
                                                <p class="text-xs text-gray-500">ID: REP-2547</p>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4">
                                            <div class="flex items-center justify-between mb-2">
                                                <h4 class="text-sm font-medium text-gray-700">Performance Impact</h4>
                                            </div>
                                            <div class="grid grid-cols-2 gap-3">
                                                <div class="text-center">
                                                    <p class="text-xs text-gray-500 mb-1">Clicks to Date</p>
                                                    <p class="text-lg font-semibold text-gray-900">124</p>
                                                </div>
                                                <div class="text-center">
                                                    <p class="text-xs text-gray-500 mb-1">Conversions</p>
                                                    <p class="text-lg font-semibold text-primary">8</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div id="disable-reason" class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Reason for disabling</label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent mb-2 h-auto">
                                            <option value="">Select a reason (required)</option>
                                            <option value="campaign-ended">Campaign ended</option>
                                            <option value="suspicious">Suspicious activity</option>
                                            <option value="rep-inactive">Rep no longer active</option>
                                            <option value="duplicate">Duplicate link</option>
                                            <option value="other">Other</option>
                                        </select>
                                        <textarea placeholder="Additional notes (optional)" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" rows="2"></textarea>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave"><i class="fa-solid fa-ban mr-2"></i>Disable Link</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--ASSIGN TO ANOTHER REP MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="assignToAnotherRepModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Assign to Another Rep</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div id="assign-rep-body" class="">
                                    <div class="mb-6">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">Link ID</h4>
                                        <div class="flex items-center">
                                            <code class="text-sm font-mono bg-gray-100 px-3 py-1.5 rounded">REF-4A7B</code>
                                        </div>
                                    </div>
                                    <div class="mb-6">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">Current Sales Rep</h4>
                                        <div class="flex items-center">
                                            <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-10 h-10 rounded-full mr-3">
                                            <div>
                                                <p class="text-sm font-medium text-gray-900">John Smith</p>
                                                <p class="text-xs text-gray-500">ID: REP-2547</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-4">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">New Sales Rep</h4>
                                        <div class="relative set-input-search-icon set-input-h-auto">
                                            <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" placeholder="Search sales reps..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent mb-2">
                                        </div>
                                        <div id="sales-rep-list" class="border border-gray-200 rounded-lg max-h-48 overflow-y-auto">
                                            <div class="p-2 hover:bg-gray-50 cursor-pointer">
                                                <div class="flex items-center">
                                                    <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-5.jpg" class="w-8 h-8 rounded-full mr-3">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-900">Sarah Johnson</p>
                                                        <p class="text-xs text-gray-500">ID: REP-6841</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="p-2 bg-blue-50 border-l-2 border-primary cursor-pointer">
                                                <div class="flex items-center">
                                                    <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-3.jpg" class="w-8 h-8 rounded-full mr-3">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-900">Mike Wilson</p>
                                                        <p class="text-xs text-gray-500">ID: REP-3298</p>
                                                    </div>
                                                    <div class="ml-auto">
                                                        <i class="fa-solid fa-check text-primary"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="p-2 hover:bg-gray-50 cursor-pointer">
                                                <div class="flex items-center">
                                                    <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-8.jpg" class="w-8 h-8 rounded-full mr-3">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-900">Alex Chen</p>
                                                        <p class="text-xs text-gray-500">ID: REP-7542</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="p-2 hover:bg-gray-50 cursor-pointer">
                                                <div class="flex items-center">
                                                    <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-9.jpg" class="w-8 h-8 rounded-full mr-3">
                                                    <div>
                                                        <p class="text-sm font-medium text-gray-900">David Lee</p>
                                                        <p class="text-xs text-gray-500">ID: REP-9214</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="assignment-notes" class="mb-4">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">Reassignment Notes (Optional)</h4>
                                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" rows="2" placeholder="Add notes about this reassignment..."></textarea>
                                    </div>
                                    <div id="assignment-notification" class="mb-4">
                                        <label class="flex items-center">
                                            <input type="checkbox" class="form-checkbox text-primary rounded set-width-30-checkbox" checked="">
                                            <span class="ml-2 text-sm text-gray-700">Notify new sales rep via email</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="button" name="addUser" class="btn btnSave"  data-bs-toggle="modal" data-bs-target="#confirmAssignmentModal">Confirm Assignment</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--CONFIRM ASSIGNMENT MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="confirmAssignmentModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Confirm Assignment</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div class="flex items-center mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
                                        <i class="fa-solid fa-info-circle text-blue-500 text-xl mr-3"></i>
                                        <p class="text-sm text-gray-700">You are about to reassign this referral link to a different sales representative. This action cannot be undone.</p>
                                    </div>
                                    
                                    <div class="flex items-center justify-between mb-4">
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-500">From</h4>
                                            <div class="flex items-center mt-2">
                                                <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-8 h-8 rounded-full mr-2">
                                                <span class="text-sm font-medium text-gray-900">John Smith</span>
                                            </div>
                                        </div>
                                        
                                        <div class="text-gray-400">
                                            <i class="fa-solid fa-arrow-right text-lg"></i>
                                        </div>
                                        
                                        <div>
                                            <h4 class="text-sm font-medium text-gray-500">To</h4>
                                            <div class="flex items-center mt-2">
                                                <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-3.jpg" class="w-8 h-8 rounded-full mr-2">
                                                <span class="text-sm font-medium text-gray-900">Mike Wilson</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">Referral Link</h4>
                                        <div class="flex items-center">
                                            <code class="text-sm font-mono bg-gray-100 px-3 py-1.5 rounded">REF-4A7B</code>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">Post</h4>
                                        <p class="text-sm text-gray-900">Premium Car Wash Service</p>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">Performance Transfer</h4>
                                        <p class="text-sm text-gray-700">All existing clicks (124) and conversions (8) will remain with the original sales rep for commission calculations.</p>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h4 class="text-sm font-medium text-gray-500 mb-2">New Commissions</h4>
                                        <p class="text-sm text-gray-700">Future conversions from this link will be credited to Mike Wilson.</p>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Confirm</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--EDIT REFERRAL LINK MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="editReferralLinkModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Edit Referral Link</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div class="mb-4">
                                        <div class="flex items-center justify-between mb-2">
                                            <label class="block text-sm font-medium text-gray-700">Link ID</label>
                                        </div>
                                        <div class="flex items-center">
                                            <code class="text-sm font-mono bg-gray-100 px-3 py-1.5 rounded w-full" id="linkIdDisplay">REF-4A7B</code>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Referral URL</label>
                                        <div class="flex">
                                            <input type="text" id="referralUrl" value="" readonly="" class="text-sm border border-gray-300 rounded-l-lg py-2 px-3 w-full bg-gray-50">
                                            <button type="button" id="shareUrlEnter" class="bg-gray-900 text-white px-3 py-2 rounded-r-lg hover:bg-gray-800 flex text-xs copy-btn">
                                                <i class="fa-solid fa-copy"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Expiry Date</label>
                                        <input type="date" name="expire_date" id="expiryDate" value="2025-01-10" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <p class="text-xs text-gray-500 mt-1">Link expires at 11:59 PM on the selected date</p>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Assigned Sales Rep</label>
                                        <div class="relative">
                                            <select id="assignedRep" name="user_id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent appearance-none pr-10 h-auto">
                                                <?php foreach($salesPerson as $k=>$v) { ?>
                                                <option value="<?php echo $v['id'];?>"><?php echo $v['name'];?></option>
                                                <?php } ?>
                                        
                                            </select>
                                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                                <i class="fa-solid fa-chevron-down text-gray-400"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                        <div class="flex items-center space-x-4">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="status" id="statusActive" value="1" class="form-radio h-4 w-4 text-primary" checked="">
                                                <span class="ml-2 text-sm text-gray-700">Active</span>
                                            </label>
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="status" id="statusSuspended" value="0" class="form-radio h-4 w-4 text-primary">
                                                <span class="ml-2 text-sm text-gray-700">Suspended</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Notes (Optional)</label>
                                        <textarea name="info" id="notes" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" rows="3" placeholder="Add notes about this referral link...">This link is for the premium car wash promotion campaign targeting existing customers.</textarea>
                                    </div>
                                    <input type="hidden" name="id" id="__linkID">
                                    
                                    <div id="post-info" class="mb-4 bg-gray-50 rounded-lg p-3 border border-gray-200">
                                        <h4 class="text-sm font-medium text-gray-700 mb-2">Linked Post</h4>
                                        <div class="flex items-start">
                                            <div class="bg-gray-100 rounded-lg w-16 h-16 flex-shrink-0 mr-3 overflow-hidden">
                                                <div class="bg-gray-100 rounded-lg w-16 h-16 flex-shrink-0 mr-3 overflow-hidden">
                                                    <img id="postImage" src="" alt="image" class="w-full h-full object-cover">
                                                </div>
                                            </div>
                                            <div>
                                                <p class="text-sm font-medium text-gray-900" id="postTitle">Premium Car Wash Service</p>
                                                <p class="text-xs text-gray-500 mb-1" id="postCategory">Automotive</p>
                                                <p class="text-xs text-gray-500" id="postId">Post ID: POST-8721</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="__editLink" class="btn btnSave">Save Changes</button>
                                    <button type="button" data-bs-dismiss="modal" class="btn btnClose">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--REFERRAL LINK DETAIL MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="referralLinkDetailModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Referral Link Details</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <!-- Left Column -->
                                        <div>
                                            <!-- Link ID -->
                                            <div class="mb-4">
                                                <h4 class="text-sm font-medium text-gray-500 mb-2">Link ID</h4>
                                                <div class="flex items-center">
                                                    <code id="modal-link-id" class="text-sm font-mono bg-gray-100 px-3 py-1.5 rounded">REF-XXXX</code>
                                                </div>
                                            </div>
                                            <!-- Link Type -->
                                            <div class="mb-4">
                                                <h4 class="text-sm font-medium text-gray-500 mb-2">Link Type</h4>
                                                <div class="flex items-center">
                                                    <code id="modal-link-type" class="text-sm font-mono bg-gray-100 px-3 py-1.5 rounded">REF-XXXX</code>
                                                </div>
                                            </div>
            
                                            <!-- Referral URL -->
                                            <div class="mb-4">
                                                <h4 class="text-sm font-medium text-gray-500 mb-2">Referral URL</h4>
                                                <div class="flex">
                                                    <input id="modal-share-link" type="text" readonly class="text-sm border border-gray-300 rounded-l-lg py-2 px-3 w-full bg-gray-50" value="">
                                                    <button type="button" id="modal-copy-btn" class="bg-gray-900 text-white px-3 py-2 rounded-r-lg hover:bg-gray-800 flex text-xs copy-btn">
                                                        <i class="fa-solid fa-copy mr-1"></i> Copy
                                                    </button>
                                                </div>
                                            </div>
            
                                            <!-- Sales Rep -->
                                            <div class="mb-6">
                                                <h4 class="text-sm font-medium text-gray-500 mb-2">Sales Rep</h4>
                                                <div class="flex items-center">
                                                    <img id="modal-user-img" src="" class="w-10 h-10 rounded-full mr-3" alt="User">
                                                    <div>
                                                        <p id="modal-user-name" class="text-sm font-medium text-gray-900">Name</p>
                                                        <p id="modal-user-id" class="text-xs text-gray-500">ID: REP-XXXX</p>
                                                    </div>
                                                </div>
                                            </div>
            
                                            <!-- Post Linked -->
                                            <div class="mb-6">
                                                <h4 class="text-sm font-medium text-gray-500 mb-2">Post Linked</h4>
                                                <div class="border border-gray-200 rounded-lg p-3">
                                                    <div class="flex items-start">
                                                        <div class="bg-gray-100 rounded-lg w-16 h-16 flex-shrink-0 mr-3 overflow-hidden">
                                                            <!-- <div class="w-full h-full bg-gray-300 flex items-center justify-center text-gray-400">
                                                                <i class="fa-solid fa-image text-xl"></i>
                                                            </div> -->
                                                            <div class="bg-gray-100 rounded-lg w-16 h-16 flex-shrink-0 mr-3 overflow-hidden">
                                                                <img id="link-post-image" src="" alt="image" class="w-full h-full object-cover">
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <p id="modal-post-title" class="text-sm font-medium text-gray-900">Post Title</p>
                                                            <p id="modal-post-category" class="text-xs text-gray-500 mb-1">Category</p>
                                                            <p id="modal-post-id" class="text-xs text-gray-500">Post ID: POST-XXXX</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
            
                                        <!-- Right Column -->
                                        <div>
                                            <div class="grid grid-cols-2 gap-4 mb-6">
                                                <div>
                                                    <h4 class="text-sm font-medium text-gray-500 mb-2">Created Date</h4>
                                                    <p id="modal-created-at" class="text-sm text-gray-900">--</p>
                                                </div>
                                                <div>
                                                    <h4 class="text-sm font-medium text-gray-500 mb-2">Expiry Date</h4>
                                                    <p id="modal-expiry-at" class="text-sm text-gray-900">--</p>
                                                </div>
                                                <div>
                                                    <h4 class="text-sm font-medium text-gray-500 mb-2">Status</h4>
                                                    <span id="modal-status" class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium">
                                                        <!-- Will be populated with status & icon -->
                                                    </span>
                                                </div>
                                                <div>
                                                    <h4 class="text-sm font-medium text-gray-500 mb-2">Source Platform</h4>
                                                    <div class="flex items-center">
                                                        <span id="modal-source-platform" class="text-sm text-gray-900">--</span>
                                                    </div>
                                                </div>
                                            </div>
            
                                            <!-- Performance -->
                                            <div class="mb-6">
                                                <h4 class="text-sm font-medium text-gray-500 mb-2">Performance</h4>
                                                <div class="grid grid-cols-2 gap-4 mb-4">
                                                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 text-center">
                                                        <p class="text-xs text-gray-500 mb-1">Total Clicks</p>
                                                        <p id="modal-clicks" class="text-xl font-semibold text-gray-900">0</p>
                                                    </div>
                                                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 text-center">
                                                        <p class="text-xs text-gray-500 mb-1">Conversions</p>
                                                        <p id="modal-conversions" class="text-xl font-semibold text-primary">0</p>
                                                    </div>
                                                </div>
                                                <div class="h-48 border border-gray-200 rounded-lg p-3" id="performance-chart"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="button" id="editButtonView" name="editLink" data-bs-toggle="modal" data-bs-target="#editReferralLinkModal" class="btn btnSave editLink"><i class="fa-solid fa-pen-to-square mr-2"></i>Edit Link</button>
                                    <button type="button" class="btn btnClose" data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- OFFCANVAS COMMUNITY FILTER PANEL -->
            <div class="offcanvas offcanvas-end set-modal-assign-community customModal" tabindex="-1" id="referalFilterOffcanvas" aria-labelledby="offcanvasRightLabel">
                <div class="modal-header p-3">
                    <h2 class="modal-title fs-5" id="addUserLabel">Filter Referral Links</h2>
                </div>
                <div class="offcanvas-body">
                    <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                        <div id="filter-panel-content" class="p-6 overflow-y-auto h-[calc(100%-130px)]">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Sales Rep</label>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-auto">
                                    <option>All Sales Reps</option>
                                    <option>John Smith</option>
                                    <option>Sarah Johnson</option>
                                    <option>Mike Wilson</option>
                                    <option>Alex Chen</option>
                                </select>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                                <div class="space-y-2">
                                    <label class="inline-flex items-center w-full p-2 border border-gray-200 rounded-lg hover:bg-gray-50">
                                        <input type="checkbox" class="form-checkbox text-primary h-4 w-4 set-width-30-checkbox" checked="">
                                        <span class="ml-2 text-sm text-gray-700">Active</span>
                                    </label>
                                    <label class="inline-flex items-center w-full p-2 border border-gray-200 rounded-lg hover:bg-gray-50">
                                        <input type="checkbox" class="form-checkbox text-primary h-4 w-4 set-width-30-checkbox" checked="">
                                        <span class="ml-2 text-sm text-gray-700">Expired</span>
                                    </label>
                                    <label class="inline-flex items-center w-full p-2 border border-gray-200 rounded-lg hover:bg-gray-50">
                                        <input type="checkbox" class="form-checkbox text-primary h-4 w-4 set-width-30-checkbox" checked="">
                                        <span class="ml-2 text-sm text-gray-700">Used</span>
                                    </label>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Date Range</label>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">From</label>
                                        <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">To</label>
                                        <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                    </div>
                                </div>
                                <div class="flex items-center mt-3 set-input-h-auto">
                                    <label class="inline-flex items-center mr-4">
                                        <input type="radio" name="date-type" value="created" class="form-radio text-primary " checked="">
                                        <span class="ml-2 text-sm text-gray-700">Created Date</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="radio" name="date-type" value="expired" class="form-radio text-primary">
                                        <span class="ml-2 text-sm text-gray-700">Expiry Date</span>
                                    </label>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Post Category</label>
                                <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent h-auto">
                                    <option>All Categories</option>
                                    <option>Automotive</option>
                                    <option>Education</option>
                                    <option>Health &amp; Fitness</option>
                                    <option>Creative</option>
                                    <option>Technology</option>
                                    <option>Food &amp; Beverage</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-2 gap-3 d-flex flex-row justify-center">
                            <button type="submit" name="addUser" class="btn btnSave">Apply Filters</button>
                            <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Reset</button></a>
                        </div>
                    </form>
                </div>
            </div>

            <!-- ========================================== -->
            <!-- Commission Settings Modals -->
            <!-- ========================================== -->
            <!-- EDIT SETTING MODAL -->
            <div class="modal fade customModal set-modal-assign-community" id="editSettingModal" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Edit Settings</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="space-y-5">
                                    <div id="modal-expiry-setting">
                                        <div class="flex items-center mb-2">
                                            <label class="block text-sm font-medium text-gray-700">Referral Link Expiry</label>
                                            <button id="modal-expiry-info" class="ml-2 text-gray-400 hover:text-gray-600">
                                                <i class="fa-solid fa-circle-info"></i>
                                            </button>
                                        </div>
                                        <div class="relative">
                                            <input type="number" id="modal-expiry" value="14" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-12">
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                <span class="text-gray-500 text-sm">days</span>
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">How long referral links stay valid after creation.</p>
                                    </div>
                                    
                                    <div id="modal-commission-setting">
                                        <div class="flex items-center mb-2">
                                            <label class="block text-sm font-medium text-gray-700">Default Commission Rate</label>
                                            <button id="modal-commission-info" class="ml-2 text-gray-400 hover:text-gray-600">
                                                <i class="fa-solid fa-circle-info"></i>
                                            </button>
                                        </div>
                                        <div class="relative">
                                            <input type="number" id="modal-commission" value="5.00" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-8">
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                <span class="text-gray-500 text-sm">%</span>
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Applies automatically when new reps are created.</p>
                                    </div>
                                    
                                    <div id="modal-inactivity-setting">
                                        <div class="flex items-center mb-2">
                                            <label class="block text-sm font-medium text-gray-700">Inactivity Threshold</label>
                                            <button id="modal-inactivity-info" class="ml-2 text-gray-400 hover:text-gray-600">
                                                <i class="fa-solid fa-circle-info"></i>
                                            </button>
                                        </div>
                                        <div class="relative">
                                            <input type="number" id="modal-inactivity" value="30" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-12">
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                <span class="text-gray-500 text-sm">days</span>
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Number of days without activity before flagging a rep.</p>
                                    </div>
                                    
                                    <div id="modal-auto-approve-setting">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center">
                                                <label class="block text-sm font-medium text-gray-700">Auto-Approve Toggle</label>
                                                <button id="modal-auto-approve-info" class="ml-2 text-gray-400 hover:text-gray-600">
                                                    <i class="fa-solid fa-circle-info"></i>
                                                </button>
                                            </div>
                                            <div class="relative">
                                                <input type="checkbox" id="modal-auto-approve-toggle" class="sr-only set-width-30-checkbox" checked="">
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Automatically approve new join requests for private communities.</p>
                                    </div>
                                    
                                    <div id="modal-max-communities-setting">
                                        <div class="flex items-center mb-2">
                                            <label class="block text-sm font-medium text-gray-700">Max Communities per Rep</label>
                                            <button id="modal-max-communities-info" class="ml-2 text-gray-400 hover:text-gray-600">
                                                <i class="fa-solid fa-circle-info"></i>
                                            </button>
                                        </div>
                                        <input type="number" id="modal-max-communities" value="5" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                                        <p class="text-xs text-gray-500 mt-1">Upper limit of communities one rep can own.</p>
                                    </div>
                                    
                                    <div id="modal-community-commission-setting">
                                        <div class="flex items-center mb-2">
                                            <label class="block text-sm font-medium text-gray-700">Community Commission Rate</label>
                                            <button id="modal-community-commission-info" class="ml-2 text-gray-400 hover:text-gray-600">
                                                <i class="fa-solid fa-circle-info"></i>
                                            </button>
                                        </div>
                                        <div class="relative">
                                            <input type="number" id="modal-community-commission" value="7.50" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent pr-8">
                                            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                                <span class="text-gray-500 text-sm">%</span>
                                            </div>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-1">Commission rate specifically for community-based sales.</p>
                                    </div>
                                    
                                    <div id="modal-notification-settings">
                                        <h4 class="font-medium text-gray-900 mb-3">Email &amp; System Notifications</h4>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm text-gray-700">Low performance alerts</span>
                                                <div class="relative">
                                                    <input type="checkbox" id="modal-email-performance" class="sr-only set-width-30-checkbox" checked="">
                                                    
                                                </div>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm text-gray-700">Commission milestones</span>
                                                <div class="relative">
                                                    <input type="checkbox" id="modal-email-commission" class="sr-only set-width-30-checkbox">
                                                   
                                                </div>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm text-gray-700">Link expiry warnings</span>
                                                <div class="relative">
                                                    <input type="checkbox" id="modal-email-expiry" class="sr-only set-width-30-checkbox" checked="">
                                                    
                                                </div>
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm text-gray-700">New rep registrations</span>
                                                <div class="relative">
                                                    <input type="checkbox" id="modal-system-registration" class="sr-only set-width-30-checkbox" checked="">
                                                  
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Save Changes</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Reset to Defaults MODAL -->
            <div class="modal fade customModal" id="resetToDefaultModals" tabindex="-1" aria-labelledby="editUserLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title fs-5" id="addUserLabel">Reset to Defaults</h2>
                        </div>
                        <div class="modal-body">
                            <form class="user-form p-0 d-flex flex-column gap-3" method="post" action="" data-parsley-validate enctype="multipart/form-data">
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <i class="fa-solid fa-exclamation-triangle text-danger text-xl"></i>
                                    </div>
                                    <h3 class="text-lg font-semibold text-gray-900">Reset to Defaults</h3>
                                </div>
                                <p class="text-center text-gray-600 mb-3">Are you sure you want to reset all commission and notification settings to their default values? This cannot be undone.</p>
                                <div class="mt-2 gap-3 d-flex flex-row justify-center">
                                    <button type="submit" name="addUser" class="btn btnSave">Reset All Settings</button>
                                    <a href="#" onclick="window.location.reload();"><button type="button" class="btn btnClose">Cancel</button></a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!-- wrapper end  -->
        <script src="assets/plugins/datatable/js/jquery.dataTables.min.js?v=<?= time() ?>"></script>
        <?php include('includes/footer-scripts.php') ?>
        <script src="assets/js/users.js?v=<?= time() ?>"></script>
        <script src="assets/js/salesPerson.js?v=<?= time() ?>"></script>

        <?php if($err == 1){ ?>
        <script>
            const modal = new bootstrap.Modal(document.getElementById('addUserModal'));
            modal.show();
            
        </script>
        <?php } else if($err == 3){ ?>
            <script>
                var __modal = new bootstrap.Modal(document.getElementById('createNewReferralLinkModal'));
                __modal.show();
                
            </script>
            <?php } ?>


            <script src="https://cdn.ckeditor.com/4.20.1/standard/ckeditor.js?v=<?= time() ?>"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const editors = document.querySelectorAll(".ckeditor");
    editors.forEach((textarea) => {
      CKEDITOR.replace(textarea.id, {
        height: 150,
        removeButtons: "Image,,Table,Iframe",
      });
    });
  });
</script>


        <script>
            




           document.addEventListener('DOMContentLoaded', function () {
                document.querySelectorAll('form').forEach(function (form) {
                    form.addEventListener('submit', function () {
                    openScreenLoader('Action in progress. Do not refresh this page...');
                    });
                });
                const urlParams = new URLSearchParams(window.location.search);
                const activeTab = urlParams.get('tab');
                const redirect = urlParams.get('redirect');

                const defaultTab = redirect || activeTab || 'sales-reps-tab';
                const targetTab = document.getElementById(defaultTab);

                if (targetTab) {
        const tabTrigger = new bootstrap.Tab(targetTab);
        tabTrigger.show();

        targetTab.addEventListener('shown.bs.tab', function () {
            // Find all tables inside the active tab pane (not the nav tab)
            const tabPane = document.querySelector(`.tab-pane#${defaultTab}`);
            if (tabPane) {
                const tables = tabPane.querySelectorAll('table');
                tables.forEach(function (table) {
                    if ($.fn.DataTable && $.fn.DataTable.isDataTable(table)) {
                        $(table).DataTable().columns.adjust().draw();
                    }
                });
            }
        }, { once: true });
    }
            });

            </script>
            
        <script>
            document.addEventListener('DOMContentLoaded', function () {
              // Handle click on the upload button
              document.querySelectorAll('.image-upload-wrapper').forEach(wrapper => {
                const fileInput = wrapper.querySelector('.photo-input');
                const uploadBtn = wrapper.querySelector('.upload-btn');
                const previewImg = wrapper.querySelector('.preview-image');
          
                uploadBtn.addEventListener('click', () => fileInput.click());
          
                fileInput.addEventListener('change', event => {
                  const file = event.target.files[0];
                  if (!file) return;
          
                  const reader = new FileReader();
                  reader.onload = function(e) {
                    previewImg.src = e.target.result;
                  };
                  reader.readAsDataURL(file);
                });
              });
            });
          </script>
          
        <script>
            $('#community,#editCommunity').select2({placeholder: "Select community", // Placeholder text
                allowClear: true,
                search:true
            });
          
            function previewImage2(event) {
              const input = event.target;
              const preview = document.getElementById('photoPreviewEdit');
            
              if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                  preview.innerHTML = `<img src="${e.target.result}" class="w-100 h-100 object-fit-cover rounded-circle" alt="Preview">`;
                };
                reader.readAsDataURL(input.files[0]);
              }
            }

            $(document).on('click', '.editReps', function () {
                var __data = $(this).attr('data-json');

                var parsed = JSON.parse(__data);


                // Set values to modal fields
                $('#editName').val(parsed.name || '');
                $('#h_id').val(parsed.id || '');

                $('#editEmail').val(parsed.email || '');
                $('#editTel').val(parsed.phone || '');
                if (parsed.status !== undefined && parsed.status !== null) {
                    $('select[name="status"]').val(parsed.status.toString());
                } else {
                    $('select[name="status"]').val('1'); // default to 'Active'
                }
                $('#info').val(parsed.info || '');

                // Set community options (if comma separated)
                if (parsed.community) {
                    var communities = parsed.community.split(','); // e.g. ['2', '5']
                    $('#editCommunity').val(communities).trigger('change'); // trigger for select2 if used
                } else {
                    $('#editCommunity').val([]).trigger('change');
                }


                // Set image if exists
                if (parsed.image) {
                    $('#image').attr('src', '<?php echo MEDIA_BASE_URL; ?>' + parsed.image);
                } else {
                    $('#image').attr('src', 'https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg');
                }

            });

            $(document).on('click', '.viewReps', function () {
                var __data = $(this).attr('data-json');
                var parsed = JSON.parse(__data);
                parsed.media_url = '<?php echo MEDIA_BASE_URL; ?>'
                populateRepDetailsModal(parsed);
            });
            // view community
            $(document).on('click', '.viewComs', function () {
                var __data = $(this).attr('data-json');
                var parsed = JSON.parse(__data);
                parsed.media_url = '<?php echo MEDIA_BASE_URL; ?>'
                showCommunityDetails(parsed);
            });
            $(document).on('click', '.editCom', function () {
                var __data = $(this).attr('data-json');
                var parsed = JSON.parse(__data);
                parsed.media_url = '<?php echo MEDIA_BASE_URL; ?>'
                showEditCommunityModal(parsed);
            });

            // view link

            $(document).on('click', '.viewLink', function () {
                var __data = $(this).attr('data-json');
                var parsed = JSON.parse(__data);
                parsed.media_url = '<?php echo MEDIA_BASE_URL; ?>'
                populateReferralModal(parsed);
            });

            // editLink
            $(document).on('click', '.editLink', function () {
                var __data = $(this).attr('data-json');
                var parsed = JSON.parse(__data);
                parsed.media_url = '<?php echo MEDIA_BASE_URL; ?>'
                populateReferralEditForm(parsed);
            });

            

        </script>
        <script>
                document.addEventListener('DOMContentLoaded', function() {
                    // Initialize earnings chart
                    Highcharts.chart('earnings-chart', {
                        chart: {
                            type: 'column',
                            style: {
                                fontFamily: 'Inter, sans-serif'
                            }
                        },
                        title: {
                            text: null
                        },
                        xAxis: {
                            categories: ['Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                            crosshair: true
                        },
                        yAxis: {
                            min: 0,
                            title: {
                                text: 'Amount ($)'
                            }
                        },
                        tooltip: {
                            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                                '<td style="padding:0"><b>${point.y}</b></td></tr>',
                            footerFormat: '</table>',
                            shared: true,
                            useHTML: true
                        },
                        plotOptions: {
                            column: {
                                pointPadding: 0.2,
                                borderWidth: 0
                            }
                        },
                        series: [{
                            name: 'Earnings',
                            data: [1200, 1650, 1800, 2100, 1950, 2340],
                            color: '#3B82F6'
                        }],
                        credits: {
                            enabled: false
                        }
                    });

                    // Modal and filter panel functionality could be added here
                });

        </script>
       
        <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Chart initialization
            function initChart() {
                Highcharts.chart('performance-chart', {
                    chart: {
                        type: 'areaspline',
                        style: {
                            fontFamily: 'Inter, sans-serif'
                        }
                    },
                    title: {
                        text: null
                    },
                    xAxis: {
                        categories: ['Dec 10', 'Dec 11', 'Dec 12', 'Dec 13', 'Dec 14', 'Dec 15'],
                        labels: {
                            style: {
                                fontSize: '10px'
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: null
                        },
                        gridLineColor: '#f3f4f6'
                    },
                    tooltip: {
                        shared: true
                    },
                    credits: {
                        enabled: false
                    },
                    plotOptions: {
                        areaspline: {
                            fillOpacity: 0.1,
                            marker: {
                                radius: 4
                            }
                        }
                    },
                    series: [{
                        name: 'Clicks',
                        color: '#3B82F6',
                        data: [18, 25, 34, 19, 15, 13]
                    }, {
                        name: 'Conversions',
                        color: '#10B981',
                        data: [1, 2, 3, 1, 0, 1]
                    }]
                });
            }

            // Initialize chart on page load
            initChart();

            // Modal controls
            const modals = {
                view: document.getElementById('view-link-modal'),
                edit: document.getElementById('edit-link-modal'),
                assign: document.getElementById('assign-rep-modal'),
                disable: document.getElementById('disable-link-modal'),
                create: document.getElementById('create-link-modal'),
                filter: document.getElementById('filter-panel-modal')
            };

            // Show modal function
            function showModal(modalId) {
                // Hide all modals first
                for (const key in modals) {
                    modals[key].classList.add('hidden');
                }
                // Show the requested modal
                modals[modalId].classList.remove('hidden');
                
                // Initialize chart if viewing link details
                if (modalId === 'view') {
                    setTimeout(() => {
                        initChart();
                    }, 100);
                }
            }

            // Close modal function
            function closeAllModals() {
                for (const key in modals) {
                    modals[key].classList.add('hidden');
                }
            }

            // Event listeners
            document.querySelectorAll('.view-link-btn').forEach(btn => {
                btn.addEventListener('click', () => showModal('view'));
            });

            document.querySelectorAll('.edit-link-btn').forEach(btn => {
                btn.addEventListener('click', () => showModal('edit'));
            });

            document.querySelectorAll('.assign-rep-btn').forEach(btn => {
                btn.addEventListener('click', () => showModal('assign'));
            });

            document.querySelectorAll('.disable-link-btn').forEach(btn => {
                btn.addEventListener('click', () => showModal('disable'));
            });

            document.getElementById('create-link-button').addEventListener('click', () => showModal('create'));
            document.getElementById('filter-button').addEventListener('click', () => showModal('filter'));

            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', closeAllModals);
            });
        });
    </script>
            </script>

            <script>
                function selectPost(el) {
  // Remove active class from all
  document.querySelectorAll('.post-item').forEach(item => {
    item.classList.remove('bg-gray-200', 'border-2');
    item.querySelector('.check-icon').classList.add('hidden');
  });

  // Add class to the selected item
  el.classList.add('bg-gray-200', 'border-2');
  el.querySelector('.check-icon').classList.remove('hidden');

  // Get post details
  const imgSrc = el.querySelector('img').src;
  const title = el.querySelector('p.text-sm').textContent;
  const category = el.querySelectorAll('p.text-xs')[0].textContent;
  const postIdText = el.querySelectorAll('p.text-xs')[1].textContent;

  // Update preview section
  document.getElementById('preview-box').innerHTML = `<label class="block text-sm font-medium text-gray-700 mb-2">Preview</label>

    <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
      <div class="flex items-start mb-4">
        <div class="bg-gray-100 rounded-lg w-16 h-16 flex-shrink-0 mr-3 overflow-hidden">
          <img src="${imgSrc}" alt="${title}" class="w-full h-full object-cover">
        </div>
        <div>
          <p class="text-sm font-medium text-gray-900">${title}</p>
          <p class="text-xs text-gray-500 mb-1">${category}</p>
       
        </div>
      </div>
      <div class="border-t border-gray-200 pt-3">
        <div class="flex items-center justify-between">
          <div class="text-xs text-gray-500">Expires: Not set</div>
          <div class="text-xs text-gray-500">${postIdText}</div>
        </div>
      </div>
    </div>
  `;

  // Update hidden input
  $('#post_id').val(el.id);
}

              </script>

    <script>
        document.getElementById('searchInput').addEventListener('input', function () {
            const searchValue = this.value.toLowerCase();
            const postItems = document.querySelectorAll('.post-item');
        
            postItems.forEach(item => {
                const title = item.getAttribute('data-title');
                if (title.includes(searchValue)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        });
        </script>

<script>
    document.addEventListener('click', function (e) {
    if (e.target.closest('.copy-btn')) {
        const btn = e.target.closest('.copy-btn');
        const link = btn.getAttribute('data-link');
        
        navigator.clipboard.writeText(link).then(() => {
        alert('Link copied: ' + link);
        }).catch(err => {
        console.error('Copy failed:', err);
        });
    }
    });

   
  </script>

  
  
              
      
    </body>
</html>

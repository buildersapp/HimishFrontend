<!DOCTYPE html>
<html lang="en">
    <?php include('includes/head.php') ?>
    <link rel="stylesheet" href="assets/plugins/datatable/css/dataTables.bootstrap5.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/rateit/rateit.css" />
    <body>
        <!-- wrapper start  -->
        <div class="wrapper relative pointAccumulation-page">
            <?php include('includes/sidebar.php') ?>

            <!-- header start  -->
            <?php include('includes/nav-header.php') ?>
            <!-- header end  -->

            <!-- content area start  -->
            <main class="userList min-vh-100">
                <div class="row g-4" id="point-acc">
                    <div class="col-xl-12">
                        <form class="cmn-card my-0" method="post" data-parsley-validate>
                            <div class="point-acc-left">
                                <h2>Point Accumulator</h2>
                                <div class="table-responsive">
                                    <table class="point-table">
                                        <?php foreach ($pointsArray as $index =>
                                        $row): ?>
                                        <tr class="hrLine">
                                            <td>
                                                <p for="increase-<?= $index ?>" class="form-label fs10"><?= htmlspecialchars($row['title']) ?></p>
                                            </td>
                                            <input type="hidden" name="rows[<?= $index ?>][type]" value="<?= htmlspecialchars($row['title']) ?>" />
                                            <td>
                                                <label for="increase-<?= $index ?>" class="form-label fs12 text-green">Increase Points</label>
                                                <input
                                                    type="number"
                                                    name="rows[<?= $index ?>][point_increase]"
                                                    value="<?= htmlspecialchars($row['point_increase']) ?>"
                                                    class="form-control"
                                                    id="increase-<?= $index ?>"
                                                />
                                            </td>
                                            <td>
                                                <div class="row g-2 align-items-center flex-nowrap">
                                                    <!-- <div class="col">
                                                        <label for="increase-<?= $index ?>" class="form-label fs12 text-green">Increase Points</label>
                                                        <input
                                                            type="number"
                                                            name="rows[<?= $index ?>][point_increase]"
                                                            value="<?= htmlspecialchars($row['point_increase']) ?>"
                                                            class="form-control"
                                                            id="increase-<?= $index ?>"
                                                            style="width: 50%;"
                                                        />
                                                    </div> -->
                                                    <div class="col fs12 text-center">
                                                        <small>
                                                            NO
                                                            <?= htmlspecialchars($row['title']) ?>
                                                            AFTER
                                                        </small>
                                                    </div>
                                                    <div class="col">
                                                        <!-- <label for="days-<?= $index ?>" class="form-label fs12">&emsp;</label> -->
                                                        <div class="d-flex gap-3">
                                                            <input
                                                                type="number"
                                                                name="rows[<?= $index ?>][decrease_days]"
                                                                value="<?= htmlspecialchars($row['decrease_days']) ?>"
                                                                class="form-control"
                                                                id="days-<?= $index ?>"
                                                            />
                                                            <span class="input-group-text">days</span>
                                                        </div>
                                                    </div>
                                                    <!-- <div class="col">
                                                        <label for="decrease-<?= $index ?>" class="form-label text-red fs12">Decrease Points</label>
                                                        <input
                                                            type="number"
                                                            name="rows[<?= $index ?>][point_decrease]"
                                                            value="<?= htmlspecialchars($row['point_decrease']) ?>"
                                                            class="form-control"
                                                            id="decrease-<?= $index ?>"
                                                            style="width: 50%;"
                                                        />
                                                    </div> -->
                                                </div>
                                            </td>
                                            <td>
                                                <div class="col">
                                                    <label for="decrease-<?= $index ?>" class="form-label text-red fs12">Decrease Points</label>
                                                    <input
                                                        type="number"
                                                        name="rows[<?= $index ?>][point_decrease]"
                                                        value="<?= htmlspecialchars($row['point_decrease']) ?>"
                                                        class="form-control"
                                                        id="decrease-<?= $index ?>"
                                                    />
                                                </div>
                                            </td>
                                        </tr>
                                        <?php endforeach; ?>
                                    </table>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row">
                                    <button type="submit" name="updatePoints" class="btn btnSave">Update</button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="col-xl-6">
                        <div class="point-acc-right py-3 px-3">
                            <div class="rating-title d-flex justify-content-between align-items-center">
                                <h2>Rating Distribution</h2>
                            </div>
                            <form id="ratingForm" method="POST">
                                <div class="starRating-wrap">
                                    <!-- single row  -->
                                    <?php foreach ($ratingArray as $index =>
                                    $row): ?>
                                    <div class="starRating-row gap-3">
                                        <div class="starRating me-2">
                                            <input
                                                type="number"
                                                name="rowsR[<?= $index ?>][min]"
                                                value="<?= htmlspecialchars($row['min']) ?>"
                                                class="form-control"
                                                id="increase-<?= $index ?>"
                                            />
                                            <p>-</p>
                                            <input
                                                type="number"
                                                name="rowsR[<?= $index ?>][max]"
                                                value="<?= htmlspecialchars($row['max']) ?>"
                                                class="form-control"
                                                id="increase-<?= $index ?>"
                                            />
                                            <input
                                                type="hidden"
                                                name="rowsR[<?= $index ?>][type]"
                                                value="<?= htmlspecialchars($row['type']) ?>"
                                                class="form-control"
                                                id="type-<?= $index ?>"
                                            />
                                        </div>
                                        <div class="starRating-img">
                                            <p><?= number_format(htmlspecialchars($row['type']), 1) ?></p>
                                            <div class="rateit" data-rateit-value="<?= htmlspecialchars($row['type']) ?>" data-rateit-ispreset="true" data-rateit-resetable="false" data-rateit-readonly="true"></div>
                                        </div>
                                    </div>
                                    <?php endforeach; ?>
                                </div>
                                <div class="mt-2 gap-3 d-flex flex-row">
                                    <button type="submit" name="updateRatings" class="btn btnSave">Update</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </main>
        </div>
        <!-- wrapper end  -->
        <script src="assets/plugins/datatable/js/jquery.dataTables.min.js?v=<?= time() ?>"></script>
        <?php include('includes/footer-scripts.php') ?>
        <script src="assets/plugins/rateit/rateit.js?v=<?= time() ?>"></script>
    </body>
</html>
